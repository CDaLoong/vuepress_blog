<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.67">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/vuepress_blog/images/c.png"><title>React | DaLoong的博客</title><meta name="description" content="DaLoong的博客">
    <link rel="preload" href="/vuepress_blog/assets/style-8ba6f110.css" as="style"><link rel="stylesheet" href="/vuepress_blog/assets/style-8ba6f110.css">
    <link rel="modulepreload" href="/vuepress_blog/assets/app-168a97af.js"><link rel="modulepreload" href="/vuepress_blog/assets/react学习.html-f8704c2c.js"><link rel="modulepreload" href="/vuepress_blog/assets/react学习.html-7cd43d5c.js"><link rel="prefetch" href="/vuepress_blog/assets/index.html-9d13c51f.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/基于GitLab Runner的CICD部署流程.html-850cfa9e.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/index.html-778cfb5b.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/CSS3学习.html-8d464183.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/ES6学习.html-b688c695.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/HTML5学习.html-a5507529.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/HTNL_CSS基础学习.html-cb14dd7a.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/JS基础学习.html-56057ea3.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/Linux学习.html-8f42b128.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/NodeJS学习.html-67dc908c.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/Rust学习.html-4bd3189d.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/git学习.html-66129482.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/js代码开发规范.html-d79c3c14.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/mysql学习.html-796ff3ec.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/vue2学习.html-9f615d29.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/webpack学习.html-91851a74.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/包管理器学习.html-904b9825.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/模块化学习.html-bf244a88.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/算法学习.html-6b287957.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/网络学习.html-f50286be.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/index.html-a58d64d2.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/基于GitLab Runner的CICD部署流程.html-ae014ee6.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/index.html-d78c947f.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/CSS3学习.html-f95e66a5.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/ES6学习.html-7c11af0a.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/HTML5学习.html-556590f3.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/HTNL_CSS基础学习.html-0002e336.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/JS基础学习.html-9e2840a4.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/Linux学习.html-f8464ebe.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/NodeJS学习.html-b7587d5e.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/Rust学习.html-0ecf461a.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/git学习.html-1c2183d0.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/js代码开发规范.html-28bcaee9.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/mysql学习.html-40a64e2f.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/vue2学习.html-4e4342be.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/webpack学习.html-97d627c2.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/包管理器学习.html-8b34adc7.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/模块化学习.html-d42f575c.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/算法学习.html-fcb50873.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/网络学习.html-b520b35d.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/404.html-69018513.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/vuepress_blog/" class=""><img class="logo" src="/vuepress_blog/images/CDaLoong-logo.png" alt="DaLoong的博客"><span class="site-name can-hide">DaLoong的博客</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/CDaLoong" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://juejin.cn/user/2375422091464398" rel="noopener noreferrer" target="_blank" aria-label="掘金"><!--[--><!--]--> 掘金 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/CDaLoong" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://juejin.cn/user/2375422091464398" rel="noopener noreferrer" target="_blank" aria-label="掘金"><!--[--><!--]--> 掘金 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/vuepress_blog/" class="sidebar-item sidebar-heading" aria-label="程序员的自我修养"><!--[--><!--]--> 程序员的自我修养 <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">学习笔记 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">HTNL+CSS学习 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/vuepress_blog/note/HTNL_CSS%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="html + css 基础"><!--[--><!--]--> html + css 基础 <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/HTML5%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="HTML5"><!--[--><!--]--> HTML5 <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/CSS3%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="CSS3"><!--[--><!--]--> CSS3 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">JS学习 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/vuepress_blog/note/JS%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="JavaScript基础"><!--[--><!--]--> JavaScript基础 <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/ES6%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="ES6+"><!--[--><!--]--> ES6+ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">工程化学习 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/vuepress_blog/note/git%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="git操作"><!--[--><!--]--> git操作 <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/%E6%A8%A1%E5%9D%97%E5%8C%96%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="模块化"><!--[--><!--]--> 模块化 <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="包管理器"><!--[--><!--]--> 包管理器 <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/webpack%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item active collapsible">前端框架学习 <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/vuepress_blog/note/vue2%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="前期准备"><!--[--><!--]--> 前期准备 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#什么是react" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是React？"><!--[--><!--]--> 什么是React？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react的特点" class="router-link-active router-link-exact-active sidebar-item" aria-label="React的特点"><!--[--><!--]--> React的特点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#对比vue" class="router-link-active router-link-exact-active sidebar-item" aria-label="对比Vue"><!--[--><!--]--> 对比Vue <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#学习路径" class="router-link-active router-link-exact-active sidebar-item" aria-label="学习路径"><!--[--><!--]--> 学习路径 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#jsx" class="router-link-active router-link-exact-active sidebar-item" aria-label="JSX"><!--[--><!--]--> JSX <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#什么是jsx" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是JSX"><!--[--><!--]--> 什么是JSX <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#在jsx中嵌入表达式" class="router-link-active router-link-exact-active sidebar-item" aria-label="在JSX中嵌入表达式"><!--[--><!--]--> 在JSX中嵌入表达式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#元素的不可变性" class="router-link-active router-link-exact-active sidebar-item" aria-label="元素的不可变性"><!--[--><!--]--> 元素的不可变性 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#使用react脚手架搭建工程" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用React脚手架搭建工程"><!--[--><!--]--> 使用React脚手架搭建工程 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#vscode插件安装" class="router-link-active router-link-exact-active sidebar-item" aria-label="VSCode插件安装"><!--[--><!--]--> VSCode插件安装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#chrome插件安装" class="router-link-active router-link-exact-active sidebar-item" aria-label="Chrome插件安装"><!--[--><!--]--> Chrome插件安装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react-的-api" class="router-link-active router-link-exact-active sidebar-item" aria-label="React 的 API"><!--[--><!--]--> React 的 API <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react-createelement" class="router-link-active router-link-exact-active sidebar-item" aria-label="React.createElement"><!--[--><!--]--> React.createElement <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#reactdom-render" class="router-link-active router-link-exact-active sidebar-item" aria-label="ReactDOM.render"><!--[--><!--]--> ReactDOM.render <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react中的元素" class="router-link-active router-link-exact-active sidebar-item" aria-label="React中的元素"><!--[--><!--]--> React中的元素 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#组件和组件属性" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件和组件属性"><!--[--><!--]--> 组件和组件属性 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#函数组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="函数组件"><!--[--><!--]--> 函数组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#类组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="类组件"><!--[--><!--]--> 类组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#组件的属性-props" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件的属性 props"><!--[--><!--]--> 组件的属性 props <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#组件状态" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件状态"><!--[--><!--]--> 组件状态 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#状态-state" class="router-link-active router-link-exact-active sidebar-item" aria-label="状态（state）"><!--[--><!--]--> 状态（state） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#组件中的数据" class="router-link-active router-link-exact-active sidebar-item" aria-label="组件中的数据"><!--[--><!--]--> 组件中的数据 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#事件" class="router-link-active router-link-exact-active sidebar-item" aria-label="事件"><!--[--><!--]--> 事件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#深入认识setstate" class="router-link-active router-link-exact-active sidebar-item" aria-label="深入认识setState"><!--[--><!--]--> 深入认识setState <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#最佳实践" class="router-link-active router-link-exact-active sidebar-item" aria-label="最佳实践"><!--[--><!--]--> 最佳实践 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#生命周期" class="router-link-active router-link-exact-active sidebar-item" aria-label="生命周期"><!--[--><!--]--> 生命周期 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#旧版生命周期" class="router-link-active router-link-exact-active sidebar-item" aria-label="旧版生命周期"><!--[--><!--]--> 旧版生命周期 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#新版生命周期" class="router-link-active router-link-exact-active sidebar-item" aria-label="新版生命周期"><!--[--><!--]--> 新版生命周期 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#传递元素内容" class="router-link-active router-link-exact-active sidebar-item" aria-label="传递元素内容"><!--[--><!--]--> 传递元素内容 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#表单" class="router-link-active router-link-exact-active sidebar-item" aria-label="表单"><!--[--><!--]--> 表单 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#受控组件和非受控组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="受控组件和非受控组件"><!--[--><!--]--> 受控组件和非受控组件 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#属性默认值和类型检查" class="router-link-active router-link-exact-active sidebar-item" aria-label="属性默认值和类型检查"><!--[--><!--]--> 属性默认值和类型检查 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#属性默认值" class="router-link-active router-link-exact-active sidebar-item" aria-label="属性默认值"><!--[--><!--]--> 属性默认值 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#属性类型检查" class="router-link-active router-link-exact-active sidebar-item" aria-label="属性类型检查"><!--[--><!--]--> 属性类型检查 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#hoc-高阶组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="HOC 高阶组件"><!--[--><!--]--> HOC 高阶组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#ref" class="router-link-active router-link-exact-active sidebar-item" aria-label="ref"><!--[--><!--]--> ref <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#reference-引用" class="router-link-active router-link-exact-active sidebar-item" aria-label="reference: 引用"><!--[--><!--]--> reference: 引用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#谨慎使用ref" class="router-link-active router-link-exact-active sidebar-item" aria-label="谨慎使用ref"><!--[--><!--]--> 谨慎使用ref <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#ref转发" class="router-link-active router-link-exact-active sidebar-item" aria-label="Ref转发"><!--[--><!--]--> Ref转发 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#forwardref方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="forwardRef方法"><!--[--><!--]--> forwardRef方法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#context" class="router-link-active router-link-exact-active sidebar-item" aria-label="Context"><!--[--><!--]--> Context <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react中的上下文特点" class="router-link-active router-link-exact-active sidebar-item" aria-label="React中的上下文特点"><!--[--><!--]--> React中的上下文特点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#旧的api-版本-16-0" class="router-link-active router-link-exact-active sidebar-item" aria-label="旧的API  版本 &lt; 16.0"><!--[--><!--]--> 旧的API  版本 &lt; 16.0 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#新版api-版本-16-0" class="router-link-active router-link-exact-active sidebar-item" aria-label="新版API  版本 &gt; 16.0"><!--[--><!--]--> 新版API  版本 &gt; 16.0 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#上下文的应用场景" class="router-link-active router-link-exact-active sidebar-item" aria-label="上下文的应用场景"><!--[--><!--]--> 上下文的应用场景 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#purecomponent-纯组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="PureComponent 纯组件"><!--[--><!--]--> PureComponent 纯组件 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#注意-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="注意"><!--[--><!--]--> 注意 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react-memo-组件-内置高阶函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="React.memo(组件)  内置高阶函数"><!--[--><!--]--> React.memo(组件)  内置高阶函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#render-props-重复代码优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="render props 重复代码优化"><!--[--><!--]--> render props 重复代码优化 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#portals-插槽" class="router-link-active router-link-exact-active sidebar-item" aria-label="Portals 插槽"><!--[--><!--]--> Portals 插槽 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#注意事件冒泡" class="router-link-active router-link-exact-active sidebar-item" aria-label="注意事件冒泡"><!--[--><!--]--> 注意事件冒泡 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#错误边界" class="router-link-active router-link-exact-active sidebar-item" aria-label="错误边界"><!--[--><!--]--> 错误边界 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#错误边界-需要自己写" class="router-link-active router-link-exact-active sidebar-item" aria-label="错误边界 需要自己写"><!--[--><!--]--> 错误边界 需要自己写 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#让某个组件捕获错误" class="router-link-active router-link-exact-active sidebar-item" aria-label="让某个组件捕获错误"><!--[--><!--]--> 让某个组件捕获错误 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#注意-2" class="router-link-active router-link-exact-active sidebar-item" aria-label="注意"><!--[--><!--]--> 注意 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react中的事件" class="router-link-active router-link-exact-active sidebar-item" aria-label="React中的事件"><!--[--><!--]--> React中的事件 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#注意事项" class="router-link-active router-link-exact-active sidebar-item" aria-label="注意事项"><!--[--><!--]--> 注意事项 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#渲染原理-超级重要-️" class="router-link-active router-link-exact-active sidebar-item" aria-label="渲染原理（超级重要‼️）"><!--[--><!--]--> 渲染原理（超级重要‼️） <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#首次渲染-新节点渲染-render-虚拟元素-绑定的根结点" class="router-link-active router-link-exact-active sidebar-item" aria-label="首次渲染(新节点渲染)  render(虚拟元素, 绑定的根结点)"><!--[--><!--]--> 首次渲染(新节点渲染)  render(虚拟元素, 绑定的根结点) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#更新节点" class="router-link-active router-link-exact-active sidebar-item" aria-label="更新节点"><!--[--><!--]--> 更新节点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#对比更新" class="router-link-active router-link-exact-active sidebar-item" aria-label="对比更新"><!--[--><!--]--> 对比更新 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#工具" class="router-link-active router-link-exact-active sidebar-item" aria-label="工具"><!--[--><!--]--> 工具 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#严格模式" class="router-link-active router-link-exact-active sidebar-item" aria-label="严格模式"><!--[--><!--]--> 严格模式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#profiler" class="router-link-active router-link-exact-active sidebar-item" aria-label="Profiler"><!--[--><!--]--> Profiler <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="HOOK"><!--[--><!--]--> HOOK <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#state-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="State Hook"><!--[--><!--]--> State Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#effect-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="Effect Hook"><!--[--><!--]--> Effect Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#自定义hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义Hook"><!--[--><!--]--> 自定义Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#reducer-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="Reducer Hook"><!--[--><!--]--> Reducer Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#context-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="Context Hook"><!--[--><!--]--> Context Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#callback-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="Callback Hook"><!--[--><!--]--> Callback Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#memo-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="Memo Hook"><!--[--><!--]--> Memo Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#ref-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="Ref Hook"><!--[--><!--]--> Ref Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#imperativehandle-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="ImperativeHandle Hook"><!--[--><!--]--> ImperativeHandle Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#layouteffect-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="LayoutEffect Hook"><!--[--><!--]--> LayoutEffect Hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#debugvalue-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="DebugValue Hook"><!--[--><!--]--> DebugValue Hook <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#csstransition" class="router-link-active router-link-exact-active sidebar-item" aria-label="CSSTransition"><!--[--><!--]--> CSSTransition <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#switchtransition" class="router-link-active router-link-exact-active sidebar-item" aria-label="SwitchTransition"><!--[--><!--]--> SwitchTransition <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#transitiongroup" class="router-link-active router-link-exact-active sidebar-item" aria-label="TransitionGroup"><!--[--><!--]--> TransitionGroup <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#应用" class="router-link-active router-link-exact-active sidebar-item" aria-label="应用"><!--[--><!--]--> 应用 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#淡入淡出组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="淡入淡出组件"><!--[--><!--]--> 淡入淡出组件 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由"><!--[--><!--]--> 路由 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react-router-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="React Router"><!--[--><!--]--> React Router <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由的两种模式" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由的两种模式"><!--[--><!--]--> 路由的两种模式 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#hash-router-哈希路由" class="router-link-active router-link-exact-active sidebar-item" aria-label="Hash Router 哈希路由"><!--[--><!--]--> Hash Router 哈希路由 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#borswer-history-router-浏览器历史记录路由" class="router-link-active router-link-exact-active sidebar-item" aria-label="Borswer History Router 浏览器历史记录路由"><!--[--><!--]--> Borswer History Router 浏览器历史记录路由 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由组件"><!--[--><!--]--> 路由组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#router组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="Router组件"><!--[--><!--]--> Router组件 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#route组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="Route组件"><!--[--><!--]--> Route组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#switch组件-react-router-dom-v6版本换了名字并更新了功能-叫routes" class="router-link-active router-link-exact-active sidebar-item" aria-label="Switch组件（react-router-dom v6版本换了名字并更新了功能，叫Routes）"><!--[--><!--]--> Switch组件（react-router-dom v6版本换了名字并更新了功能，叫Routes） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由信息"><!--[--><!--]--> 路由信息 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#history" class="router-link-active router-link-exact-active sidebar-item" aria-label="history"><!--[--><!--]--> history <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#location" class="router-link-active router-link-exact-active sidebar-item" aria-label="location"><!--[--><!--]--> location <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#match" class="router-link-active router-link-exact-active sidebar-item" aria-label="match"><!--[--><!--]--> match <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#非路由组件获取路由信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="非路由组件获取路由信息"><!--[--><!--]--> 非路由组件获取路由信息 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#其他组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="其他组件"><!--[--><!--]--> 其他组件 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#link" class="router-link-active router-link-exact-active sidebar-item" aria-label="Link"><!--[--><!--]--> Link <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#navlink" class="router-link-active router-link-exact-active sidebar-item" aria-label="NavLink"><!--[--><!--]--> NavLink <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#redirect-react-router-dom-v6版本换了名字并更新了功能-叫usenavigate" class="router-link-active router-link-exact-active sidebar-item" aria-label="Redirect（react-router-dom v6版本换了名字并更新了功能，叫useNavigate）"><!--[--><!--]--> Redirect（react-router-dom v6版本换了名字并更新了功能，叫useNavigate） <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#导航守卫" class="router-link-active router-link-exact-active sidebar-item" aria-label="导航守卫"><!--[--><!--]--> 导航守卫 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#history对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="history对象"><!--[--><!--]--> history对象 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由根组件堵塞跳转属性" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由根组件堵塞跳转属性"><!--[--><!--]--> 路由根组件堵塞跳转属性 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#常见应用" class="router-link-active router-link-exact-active sidebar-item" aria-label="常见应用"><!--[--><!--]--> 常见应用 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由切换动画" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由切换动画"><!--[--><!--]--> 路由切换动画 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#path-to-regexp" class="router-link-active router-link-exact-active sidebar-item" aria-label="path-to-regexp"><!--[--><!--]--> path-to-regexp <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#history对象-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="history对象"><!--[--><!--]--> history对象 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#history对象-2" class="router-link-active router-link-exact-active sidebar-item" aria-label="history对象"><!--[--><!--]--> history对象 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#createbrowserhistory" class="router-link-active router-link-exact-active sidebar-item" aria-label="createBrowserHistory"><!--[--><!--]--> createBrowserHistory <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#createhashhistory" class="router-link-active router-link-exact-active sidebar-item" aria-label="createHashHistory"><!--[--><!--]--> createHashHistory <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#creatememoryhistory" class="router-link-active router-link-exact-active sidebar-item" aria-label="createMemoryHistory"><!--[--><!--]--> createMemoryHistory <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写createbrowserhistory" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写createBrowserHistory"><!--[--><!--]--> 手写createBrowserHistory <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#创建location" class="router-link-active router-link-exact-active sidebar-item" aria-label="创建location"><!--[--><!--]--> 创建location <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写router" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写Router"><!--[--><!--]--> 手写Router <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写route" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写Route"><!--[--><!--]--> 手写Route <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写switch" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写Switch"><!--[--><!--]--> 手写Switch <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写withrouter" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写withRouter"><!--[--><!--]--> 手写withRouter <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写link" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写Link"><!--[--><!--]--> 手写Link <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#mvc" class="router-link-active router-link-exact-active sidebar-item" aria-label="MVC"><!--[--><!--]--> MVC <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#前端需要一个独立的数据解决方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="前端需要一个独立的数据解决方案"><!--[--><!--]--> 前端需要一个独立的数据解决方案 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#flux" class="router-link-active router-link-exact-active sidebar-item" aria-label="Flux"><!--[--><!--]--> Flux <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#redux-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="Redux"><!--[--><!--]--> Redux <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#action" class="router-link-active router-link-exact-active sidebar-item" aria-label="Action"><!--[--><!--]--> Action <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#reducer" class="router-link-active router-link-exact-active sidebar-item" aria-label="Reducer"><!--[--><!--]--> Reducer <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#store" class="router-link-active router-link-exact-active sidebar-item" aria-label="Store"><!--[--><!--]--> Store <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写createstore" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写createStore"><!--[--><!--]--> 手写createStore <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写bindactioncreators" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写bindActionCreators"><!--[--><!--]--> 手写bindActionCreators <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写combinereducers" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写combineReducers"><!--[--><!--]--> 手写combineReducers <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#redux中间件-middleware" class="router-link-active router-link-exact-active sidebar-item" aria-label="Redux中间件（Middleware）"><!--[--><!--]--> Redux中间件（Middleware） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写applymiddleware" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写applyMiddleware"><!--[--><!--]--> 手写applyMiddleware <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#利用中间件进行副作用处理" class="router-link-active router-link-exact-active sidebar-item" aria-label="利用中间件进行副作用处理"><!--[--><!--]--> 利用中间件进行副作用处理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#用-reudx-thunk-管理学生数据" class="router-link-active router-link-exact-active sidebar-item" aria-label="用 Reudx + thunk 管理学生数据"><!--[--><!--]--> 用 Reudx + thunk 管理学生数据 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#redux-promise" class="router-link-active router-link-exact-active sidebar-item" aria-label="redux-promise"><!--[--><!--]--> redux-promise <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#迭代器和可迭代协议" class="router-link-active router-link-exact-active sidebar-item" aria-label="迭代器和可迭代协议"><!--[--><!--]--> 迭代器和可迭代协议 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#迭代" class="router-link-active router-link-exact-active sidebar-item" aria-label="迭代"><!--[--><!--]--> 迭代 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#迭代器-iterator" class="router-link-active router-link-exact-active sidebar-item" aria-label="迭代器 iterator"><!--[--><!--]--> 迭代器 iterator <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#可迭代协议" class="router-link-active router-link-exact-active sidebar-item" aria-label="可迭代协议"><!--[--><!--]--> 可迭代协议 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#for-of循环的原理" class="router-link-active router-link-exact-active sidebar-item" aria-label="for-of循环的原理"><!--[--><!--]--> for-of循环的原理 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#生成器-generator" class="router-link-active router-link-exact-active sidebar-item" aria-label="生成器 generator"><!--[--><!--]--> 生成器 generator <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#generator" class="router-link-active router-link-exact-active sidebar-item" aria-label="generator"><!--[--><!--]--> generator <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#generator-function" class="router-link-active router-link-exact-active sidebar-item" aria-label="generator function"><!--[--><!--]--> generator function <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#redux-saga" class="router-link-active router-link-exact-active sidebar-item" aria-label="redux-saga"><!--[--><!--]--> redux-saga <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写saga" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写saga"><!--[--><!--]--> 手写saga <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react-redux" class="router-link-active router-link-exact-active sidebar-item" aria-label="react-redux"><!--[--><!--]--> react-redux <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#react-redux-其他api" class="router-link-active router-link-exact-active sidebar-item" aria-label="react-redux 其他api"><!--[--><!--]--> react-redux 其他api <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#redux-actions" class="router-link-active router-link-exact-active sidebar-item" aria-label="redux-actions"><!--[--><!--]--> redux-actions <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#createaction-s" class="router-link-active router-link-exact-active sidebar-item" aria-label="createAction(s)"><!--[--><!--]--> createAction(s) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#handleaction-s" class="router-link-active router-link-exact-active sidebar-item" aria-label="handleAction(s)"><!--[--><!--]--> handleAction(s) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#combineactions" class="router-link-active router-link-exact-active sidebar-item" aria-label="combineActions"><!--[--><!--]--> combineActions <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#connectrouter" class="router-link-active router-link-exact-active sidebar-item" aria-label="connectRouter"><!--[--><!--]--> connectRouter <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#routermiddleware" class="router-link-active router-link-exact-active sidebar-item" aria-label="routerMiddleware"><!--[--><!--]--> routerMiddleware <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#connectedrouter" class="router-link-active router-link-exact-active sidebar-item" aria-label="ConnectedRouter"><!--[--><!--]--> ConnectedRouter <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#一些action创建函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="一些action创建函数"><!--[--><!--]--> 一些action创建函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#手写connected-react-router" class="router-link-active router-link-exact-active sidebar-item" aria-label="手写connected-react-router"><!--[--><!--]--> 手写connected-react-router <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#dva的使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="dva的使用"><!--[--><!--]--> dva的使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#dva插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="dva插件"><!--[--><!--]--> dva插件 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#dva-loading" class="router-link-active router-link-exact-active sidebar-item" aria-label="dva-loading"><!--[--><!--]--> dva-loading <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#全局安装umi" class="router-link-active router-link-exact-active sidebar-item" aria-label="全局安装umi"><!--[--><!--]--> 全局安装umi <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#约定式路由" class="router-link-active router-link-exact-active sidebar-item" aria-label="约定式路由"><!--[--><!--]--> 约定式路由 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由匹配" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由匹配"><!--[--><!--]--> 路由匹配 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由跳转" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由跳转"><!--[--><!--]--> 路由跳转 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#路由信息的获取" class="router-link-active router-link-exact-active sidebar-item" aria-label="路由信息的获取"><!--[--><!--]--> 路由信息的获取 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#配置式路由" class="router-link-active router-link-exact-active sidebar-item" aria-label="配置式路由"><!--[--><!--]--> 配置式路由 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#使用dva" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用dva"><!--[--><!--]--> 使用dva <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#定义全局模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="定义全局模型"><!--[--><!--]--> 定义全局模型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#定义局部模型" class="router-link-active router-link-exact-active sidebar-item" aria-label="定义局部模型"><!--[--><!--]--> 定义局部模型 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#使用样式" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用样式"><!--[--><!--]--> 使用样式 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#局部样式和全局样式" class="router-link-active router-link-exact-active sidebar-item" aria-label="局部样式和全局样式"><!--[--><!--]--> 局部样式和全局样式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#less" class="router-link-active router-link-exact-active sidebar-item" aria-label="less"><!--[--><!--]--> less <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#代理和数据模拟" class="router-link-active router-link-exact-active sidebar-item" aria-label="代理和数据模拟"><!--[--><!--]--> 代理和数据模拟 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#代理" class="router-link-active router-link-exact-active sidebar-item" aria-label="代理"><!--[--><!--]--> 代理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#数据模拟" class="router-link-active router-link-exact-active sidebar-item" aria-label="数据模拟"><!--[--><!--]--> 数据模拟 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="配置"><!--[--><!--]--> 配置 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#额外的约定文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="额外的约定文件"><!--[--><!--]--> 额外的约定文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#umirc配置" class="router-link-active router-link-exact-active sidebar-item" aria-label="umirc配置"><!--[--><!--]--> umirc配置 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#umi脚手架" class="router-link-active router-link-exact-active sidebar-item" aria-label="umi脚手架"><!--[--><!--]--> umi脚手架 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress_blog/note/react%E5%AD%A6%E4%B9%A0.html#form" class="router-link-active router-link-exact-active sidebar-item" aria-label="Form"><!--[--><!--]--> Form <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">计算机基础知识学习 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/vuepress_blog/note/%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item collapsible">全栈能力学习 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/vuepress_blog/note/NodeJS%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="Node"><!--[--><!--]--> Node <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/mysql%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="MySQL数据库"><!--[--><!--]--> MySQL数据库 <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/Linux%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a><!----></li><li><a href="/vuepress_blog/note/Rust%E5%AD%A6%E4%B9%A0.html" class="sidebar-item" aria-label="这就是Rust"><!--[--><!--]--> 这就是Rust <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">代码风格 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">代码开发规范 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/vuepress_blog/note/js%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83.html" class="sidebar-item" aria-label="js代码规范"><!--[--><!--]--> js代码规范 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">实战记录 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item collapsible">代码自动化流水线部署 <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/vuepress_blog/blog/%E5%9F%BA%E4%BA%8EGitLab%20Runner%E7%9A%84CICD%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B.html" class="sidebar-item" aria-label="基于GitLab Runner的CICD部署流程"><!--[--><!--]--> 基于GitLab Runner的CICD部署流程 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="react" tabindex="-1"><a class="header-anchor" href="#react" aria-hidden="true">#</a> React</h1><blockquote><p>官网：<a href="https://react.docschina.org/" target="_blank" rel="noopener noreferrer">https://react.docschina.org/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h2 id="什么是react" tabindex="-1"><a class="header-anchor" href="#什么是react" aria-hidden="true">#</a> 什么是React？</h2><ul><li>React是由<strong>Facebook</strong>研发的、用于<strong>解决UI复杂度</strong>的开源<strong>JavaScript库</strong>，目前由React联合社区维护</li><li>它不是框架，只是为了解决UI复杂度而诞生的一个库</li></ul><h2 id="react的特点" tabindex="-1"><a class="header-anchor" href="#react的特点" aria-hidden="true">#</a> React的特点</h2><ul><li>轻量：React的开发版所有源码（包含注释）仅3000多行</li><li>原生：所有的React的代码都是用原生JS书写而成的，不依赖其他任何库</li><li>易扩展：React对代码的封装程度较低，也没有过多的使用魔法，所以React中的很多功能都可以扩展</li><li>不依赖宿主环境：React只依赖原生JS语言，不依赖任何其他东西，包括运行环境。因此，它可以被轻松的移植到浏览器、桌面应用、移动端</li><li>渐近式：React并非框架，对整个工程没有强制约束力。这对与那些已存在的工程，可以逐步的将其改造为React，而不需要全盘重写</li><li>单向数据流：所有的数据自顶而下的流动</li><li>用JS代码声明界面</li><li>组件化</li></ul><h2 id="对比vue" tabindex="-1"><a class="header-anchor" href="#对比vue" aria-hidden="true">#</a> 对比Vue</h2><table><thead><tr><th>对比项</th><th>Vue</th><th>React</th></tr></thead><tbody><tr><td>全球使用量</td><td></td><td></td></tr><tr><td>✔</td><td></td><td></td></tr><tr><td>国内使用量</td><td>✔</td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td>性能</td><td>✔</td><td>✔</td></tr><tr><td>易上手</td><td>✔</td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td>灵活度</td><td></td><td></td></tr><tr><td>✔</td><td></td><td></td></tr><tr><td>大型企业</td><td></td><td></td></tr><tr><td>✔</td><td></td><td></td></tr><tr><td>中小型企业</td><td>✔</td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td>生态</td><td></td><td></td></tr><tr><td>✔</td><td></td><td></td></tr></tbody></table><h2 id="学习路径" tabindex="-1"><a class="header-anchor" href="#学习路径" aria-hidden="true">#</a> 学习路径</h2><p>整体原则：熟悉API --&gt; 深入理解原理</p><ol><li>React <ol><li>基础：掌握React的基本使用方法，有能力制作各种组件，并理解其基本运作原理</li><li>进阶：掌握React中的一些高级用法，提高代码质量</li></ol></li><li><a href="https://react-guide.github.io/react-router-cn/" target="_blank" rel="noopener noreferrer">React-Router<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：相当于vue-router</li><li><a href="http://cn.redux.js.org/" target="_blank" rel="noopener noreferrer">Redux<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>：相当于Vuex <ol><li>Redux本身</li><li>各种中间件</li></ol></li><li>第三方脚手架：<a href="https://umijs.org/zh-CN/docs" target="_blank" rel="noopener noreferrer">umi<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>UI库：<a href="https://ant.design/index-cn" target="_blank" rel="noopener noreferrer">Ant Design<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，相当于Vue的Element-UI 或 IView</li><li>源码部分 <ol><li>React源码分析</li><li>Redux源码分析</li></ol></li></ol><h2 id="jsx" tabindex="-1"><a class="header-anchor" href="#jsx" aria-hidden="true">#</a> <a href="https://zh-hans.reactjs.org/docs/introducing-jsx.html" target="_blank" rel="noopener noreferrer">JSX<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h2><h3 id="什么是jsx" tabindex="-1"><a class="header-anchor" href="#什么是jsx" aria-hidden="true">#</a> 什么是JSX</h3><ul><li>Facebook起草的JS扩展语法</li><li>本质是一个JS对象，会被babel编译，最终会被转换为React.createElement <ul><li>**&lt;<strong>script type=&quot;text/babel&quot;</strong>&gt;&lt;/<strong>script</strong>&gt; **告诉浏览器交给babel转译</li><li>直接书写html格式的表达式<code>const span = &lt;span&gt;一个span元素&lt;/span&gt;</code></li></ul></li><li>每个JSX表达式，有且仅有一个根节点 <ul><li>React.Fragment 空节点 &lt;React.Fragment&gt;&lt;/React.Fragment&gt; 可以省略为&lt;&gt;&lt;/&gt;</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token comment">// 创建空的根结点</span>
<span class="token keyword">const</span> h1 <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> // 语法糖，真实的写法是 &lt;React.Fragment&gt;&lt;/React.Fragment&gt;
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">hellow world</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">hi</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>每个JSX元素必须有结束‘/’（XML规范）</li><li>在 React 中配合使用， 可以很好地描述 UI 应该呈现出它应有交互的本质形式，具有 JavaScript 的全部功能</li><li><strong>凡是使用JSX的文件，必须导入React</strong></li><li>JSX中可以嵌入js表达式，加大括号就行</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1234</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">5678</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>a<span class="token punctuation">}</span><span class="token plain-text"> * </span><span class="token punctuation">{</span>b<span class="token punctuation">}</span><span class="token plain-text"> = </span><span class="token punctuation">{</span>a <span class="token operator">*</span> b<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> * </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>a<span class="token operator">*</span>b<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="在jsx中嵌入表达式" tabindex="-1"><a class="header-anchor" href="#在jsx中嵌入表达式" aria-hidden="true">#</a> 在JSX中嵌入表达式</h3><ul><li>变量和表达式使用{}包住</li><li>在JSX中使用注释，使用<code>{/*注释内容*/}</code></li><li>表达式可以作为内容的一部分 <ul><li>null、undefined、false不会显示</li><li>普通对象，不可以作为子元素</li><li>可以放置React元素对象</li><li>可以放置数组，但是数组中不能有普通对象</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
numbers<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> lis <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 需要加key</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>表达式可以作为元素属性</li><li>属性使用小驼峰命名法</li><li>防止注入攻击 <ul><li>自动编码</li><li>dangerouslySetInnerHTML // 使用该种方式不安全，代码层面故意比较复杂</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token string">&#39;&lt;h1&gt;一级标题&lt;/h1&gt;&#39;</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
    <span class="token literal-property property">__html</span><span class="token operator">:</span> content
<span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="元素的不可变性" tabindex="-1"><a class="header-anchor" href="#元素的不可变性" aria-hidden="true">#</a> 元素的不可变性</h3><ul><li>虽然JSX元素是一个对象，但是该对象中的所有属性不可更改，也就是JSX元素一旦创建不可修改</li><li>如果确实需要更改元素的属性，需要重新创建JSX元素</li></ul><h2 id="使用react脚手架搭建工程" tabindex="-1"><a class="header-anchor" href="#使用react脚手架搭建工程" aria-hidden="true">#</a> 使用React脚手架搭建工程</h2><p>官方：create-react-app 第三方：next.js、umijs</p><ul><li>create-react-app： yarn create react-app &#39;文件name&#39;</li></ul><h2 id="vscode插件安装" tabindex="-1"><a class="header-anchor" href="#vscode插件安装" aria-hidden="true">#</a> VSCode插件安装</h2><ul><li>ESLint：代码风格检查</li><li>ES7 React/Redux/GraphQL/React-Native snippets：快速代码编写</li></ul><h2 id="chrome插件安装" tabindex="-1"><a class="header-anchor" href="#chrome插件安装" aria-hidden="true">#</a> Chrome插件安装</h2><ul><li>React Developer Tools</li></ul><h2 id="react-的-api" tabindex="-1"><a class="header-anchor" href="#react-的-api" aria-hidden="true">#</a> React 的 API</h2><p>直接在页面上使用React，引用下面的JS</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/react@16/umd/react.development.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/react-dom@16/umd/react-dom.development.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">crossorigin</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/babel-standalone@6/babel.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
// crossorigin 的作用是报错时精准定位是链接的js的问题
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="react-createelement" tabindex="-1"><a class="header-anchor" href="#react-createelement" aria-hidden="true">#</a> React.createElement</h3><p>创建一个React元素，称作虚拟DOM，本质上是一个对象</p><ul><li>参数1：元素类型，如果是字符串，一个普通的HTML元素</li><li>参数2：元素的属性，一个对象</li><li>后续参数：元素的子节点</li></ul><h3 id="reactdom-render" tabindex="-1"><a class="header-anchor" href="#reactdom-render" aria-hidden="true">#</a> ReactDOM.render</h3><ul><li>渲染dom <ul><li>参数1是虚拟元素</li><li>参数2是绑定的根结点</li></ul></li><li>内部做了优化，每次渲染的虚拟dom对象数据变化都是更改修改的部分，也就是尽可能的不删除重新创建dom</li></ul><h2 id="react中的元素" tabindex="-1"><a class="header-anchor" href="#react中的元素" aria-hidden="true">#</a> React中的元素</h2><ul><li>React 元素：React 封装好的内部元素 div、span、p、h1 等等</li><li>组件元素</li></ul><h2 id="组件和组件属性" tabindex="-1"><a class="header-anchor" href="#组件和组件属性" aria-hidden="true">#</a> 组件和组件属性</h2><p>组件：包含内容、样式和功能的UI单元 <strong>特别注意：组件的名称首字母必须大写</strong></p><ul><li><strong>首字母小写会被当作普通元素</strong></li><li><strong>组件的类型是一个函数，type值会变化</strong></li></ul><h3 id="函数组件" tabindex="-1"><a class="header-anchor" href="#函数组件" aria-hidden="true">#</a> 函数组件</h3><ul><li>返回一个React元素，返回一个 React.createElement 或JSX</li><li>可以返回null，组件结构渲染但不显示内容</li></ul><h3 id="类组件" tabindex="-1"><a class="header-anchor" href="#类组件" aria-hidden="true">#</a> 类组件</h3><ul><li>必须继承React.Component</li><li>必须提供render函数，用于渲染组件</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">myClassComp</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 该方法必须返回React元素
     * */</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">类组件的内容</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="组件的属性-props" tabindex="-1"><a class="header-anchor" href="#组件的属性-props" aria-hidden="true">#</a> 组件的属性 props</h3><ul><li>对于函数组件，属性会作为一个对象的属性，传递给函数的参数</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>ui<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">用户传入的属性</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>numbers<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>ui<span class="token punctuation">}</span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">函数组件内容: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>numbers<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
<span class="token comment">// =============================</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyTestOne</span></span> <span class="token attr-name">numbers</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>20<span class="token punctuation">&#39;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyTestOne</span></span> <span class="token attr-name">numbers</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">40</span><span class="token punctuation">}</span></span> <span class="token attr-name">ui</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">这是我传递的属性</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>对于类组件，属性会作为一个对象的属性，传递给构造函数的参数</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">myClassComp</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 必须提供render方法，该方法必须返回React元素
     * */</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">类组件的内容: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// =================</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyClassComp</span></span> <span class="token attr-name">enable</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span></span> <span class="token attr-name">obj</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;test&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>注意：组件的属性，应该使用小驼峰命名法</li><li><strong>组件无法改变自身的属性</strong></li><li>之前学习的React元素，本质上，就是一个组件（内置组件）</li></ul><p><strong>React中的根本哲学：数据属于谁，谁才有权力改动，也就是传入组件内的数据不允许修改，虽然对象内的数据可以修改（React监控不到），但是建议不要这样做，很难维护</strong><strong>React中的数据，自顶而下流动，单向数据流，结构十分清晰</strong></p><h2 id="组件状态" tabindex="-1"><a class="header-anchor" href="#组件状态" aria-hidden="true">#</a> 组件状态</h2><ul><li>组件状态：就是组件可以自行维护的数据，组件自己的数据</li><li>组件状态仅在类组件中有效，函数组件也能用，需要钩子，后边学</li></ul><h3 id="状态-state" tabindex="-1"><a class="header-anchor" href="#状态-state" aria-hidden="true">#</a> 状态（state）</h3><p>本质上是类组件的一个属性，是一个对象</p><h4 id="状态初始化" tabindex="-1"><a class="header-anchor" href="#状态初始化" aria-hidden="true">#</a> 状态初始化</h4><ul><li>构造函数中进行初始化<code>this.state= { data: this.props.data }</code></li></ul><h4 id="状态的变化" tabindex="-1"><a class="header-anchor" href="#状态的变化" aria-hidden="true">#</a> 状态的变化</h4><ul><li><strong>不能直接改变状态：因为React无法监控到状态发生了变化</strong></li><li><strong>必须使用 this.setState({}) 改变状态</strong><ul><li><strong>this.setState({}) 会重新设置组件状态，并自动触发重新渲染</strong></li><li><strong>本质上是对组件状态的数据混合，状态中有的数据进行覆盖，没有的进行增加</strong><ul><li><code>this.setState({ data: this.state.data - 1, newData: newData })</code></li></ul></li></ul></li><li><strong>一旦调用了 this.setState，就会导致当前组件重新渲染</strong></li></ul><h2 id="组件中的数据" tabindex="-1"><a class="header-anchor" href="#组件中的数据" aria-hidden="true">#</a> 组件中的数据</h2><ul><li>props：该数据是由组件的使用者传递的数据，所有权不属于组件自身，因此组件无法改变该数据</li><li>state：该数组是由组件自身创建的，所有权属于组件自身，因此组件有权改变该数据</li></ul><h2 id="事件" tabindex="-1"><a class="header-anchor" href="#事件" aria-hidden="true">#</a> 事件</h2><ul><li>在React中，组件的事件，本质上就是一个属性，组件内通过props拿到后调用</li><li>按照之前React对组件的约定，<strong>由于事件本质上是一个属性，因此也需要使用小驼峰命名法</strong></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;点击了&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">按钮</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">// ================</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;点击了&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">按钮</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>如果没有特殊处理，在事件处理函数中，this指向undefined</strong><ul><li>使用bind函数，绑定this</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;点击了&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 对象上有当前函数，原型上也有当前函数</span>
<span class="token comment">// or</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">按钮</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>  <span class="token comment">// 不建议这样做，会有效率问题，因为每次绑定this都是创建新函数的一次过程</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用箭头函数，建议使用</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  <span class="token comment">// js next 语法，可以使用，babel会编译，效率更高，只有对象上有当前函数，原型上没有</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;点击了&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// or</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 不建议这样做，会导致 render 中的代码太复杂，不方便阅读维护</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;点击了&#39;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">按钮</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="深入认识setstate" tabindex="-1"><a class="header-anchor" href="#深入认识setstate" aria-hidden="true">#</a> 深入认识setState</h2><ul><li>setState，来自于父类，它对状态的改变，<strong>可能</strong>是异步的 <ul><li><strong>如果改变状态的代码处于某个HTML元素的事件中，则其是异步的，否则是同步</strong></li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token number">20</span>
  <span class="token punctuation">}</span>
<span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 回调函数，状态完成改变之后触发，运行在回调之后</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number<span class="token punctuation">)</span> <span class="token comment">// 先打印这个</span>
<span class="token punctuation">}</span>
<span class="token comment">// HTML元素事件</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;重新渲染&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 再打印这个，此时state中的状态还未改变</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                按钮
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code>    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token number">20</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 非HTML元素事件</span>
        <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">number</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number<span class="token punctuation">)</span> <span class="token comment">// 再打印这个，不信你自己试试，🤨，属实🐮</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;重新渲染&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 此时state中的状态已经改变，先打印这个</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    按钮
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>如果遇到某个事件中，需要同步调用多次，需要使用函数的方式得到最新状态</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 参数 prev 表示当前的状态</span>
  <span class="token comment">// 该函数的返回结果，会混合（覆盖）掉之前的状态</span>
  <span class="token comment">// 该函数是异步执行的，放在了一个队列中，执行完一个再执行一个</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">number</span><span class="token operator">:</span> prev<span class="token punctuation">.</span>number <span class="token operator">+</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">number</span><span class="token operator">:</span> prev<span class="token punctuation">.</span>number <span class="token operator">+</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">prev</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">number</span><span class="token operator">:</span> prev<span class="token punctuation">.</span>number <span class="token operator">+</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 以上代码 runder 函数只执行一次</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践" aria-hidden="true">#</a> 最佳实践</h3><ul><li>把所有的 setState 当作是异步的</li><li>永远不要信任 setState 调用之后的状态</li><li>如果要使用改变之后的状态，需要使用回调函数（setState的第二个参数）</li><li>如果新的状态要根据之前的状态进行运算，使用函数的方式改变状态（setState的第一个函数）</li><li>React 会对异步的 setState 进行优化，将多次 setState 进行合并（将多次状态改变完成后，再统一对 state 进行改变，然后触发 render）</li></ul><h2 id="生命周期" tabindex="-1"><a class="header-anchor" href="#生命周期" aria-hidden="true">#</a> 生命周期</h2><p>生命周期：组件从诞生到销毁会经历一系列的过程，该过程就叫做生命周期。React在组件的生命周期中提供了一系列的钩子函数（类似于事件），可以让开发者在函数中注入代码，这些代码会在适当的时候运行。 <strong>生命周期仅存在于类组件中，函数组件每次调用都是重新运行函数，旧的组件即刻被销毁，生命周期很短。</strong></p><h3 id="旧版生命周期" tabindex="-1"><a class="header-anchor" href="#旧版生命周期" aria-hidden="true">#</a> 旧版生命周期</h3><p><strong>React &lt; 16.0.0</strong><img src="/vuepress_blog/assets/1-70f02bdc.png" alt="image.png"></p><ol><li>constructor 构造函数 初始化阶段 <ol><li>同一个组件对象只会创建一次</li><li>不能在第一次挂载到页面之前，调用setState，为了避免问题，构造函数中严禁使用setState</li></ol></li><li>componentWillMount 初始化挂载完成 <ol><li>正常情况下，和构造函数一样，它只会运行一次</li><li>可以使用setState，但是为了避免bug，不允许使用，因为在某些特殊情况下，该函数可能被调用多次，可能会在没有挂载完的时候被打断重新挂载</li></ol></li><li><strong>render</strong><ol><li>返回一个虚拟DOM，会被挂载到虚拟DOM树中，最终渲染到页面的真实DOM中</li><li>render可能不只运行一次，只要需要重新渲染，就会重新运行</li><li>可以使用setState，但是为了避免bug，严禁使用setState，因为可能会导致无限递归渲染</li></ol></li><li><strong>componentDidMount 更新挂载完成，进入更新阶段，超级常用</strong><ol><li>只会执行一次</li><li>可以使用setState</li><li>通常情况下，会将网络请求、启动计时器等一开始需要的操作，书写到该函数中</li></ol></li><li>组件进入活跃状态</li><li>componentWillReceiveProps <ol><li>即将接收新的属性值</li><li>参数为新的属性对象</li><li>该函数可能会导致一些bug，所以不推荐使用</li></ol></li><li><strong>shouldComponentUpdate</strong><ol><li>可以做性能优化，指示React是否要重新渲染该组件，通过返回true和false来指定</li><li>默认情况下，会直接返回true</li></ol></li><li>componentWillUpdate <ol><li>组件即将被重新渲染，没啥用的感觉</li></ol></li><li>componentDidUpdate <ol><li>已经完成组件渲染</li><li>往往在该函数中使用dom操作，改变元素</li></ol></li><li><strong>componentWillUnmount 销毁阶段</strong></li><li>通常在该函数中销毁一些组件依赖的资源，比如计时器</li></ol><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 初始化阶段</span>
  <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;constructor&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;一个新的组件诞生了！！！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 即将挂载</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;componentWillMount&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;组件即将被挂载&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 挂载完成</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;componentDidMount&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;挂载完成&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span><span class="token parameter">nextProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 接收到新的属性值</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;componentWillReceiveProps&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;接收到新的属性值&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span> nextProps<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> nextState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 性能优化，是否重新渲染</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;shouldComponentUpdate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;是否应该重新渲染&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span> nextProps<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>n <span class="token operator">===</span> nextProps<span class="token punctuation">.</span>n <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n <span class="token operator">===</span> nextState<span class="token punctuation">.</span>n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token comment">// return false;</span>
<span class="token punctuation">}</span>
<span class="token function">componentWillUpdate</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> nextState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 即将重新渲染，没啥用的感觉</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;componentWillUpdate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;组件即将被重新渲染&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 重新渲染完成</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;componentDidUpdate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;组件已完成重新渲染&quot;</span><span class="token punctuation">,</span> prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 组件销毁</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;componentWillUnmount&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;组件被销毁&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 渲染</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;render&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;渲染，返回的React元素会被挂载到虚拟DOM树中&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">旧版生命周期组件</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">属性n: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>n<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">状态n：</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">n</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">1</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">状态n+1</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="新版生命周期" tabindex="-1"><a class="header-anchor" href="#新版生命周期" aria-hidden="true">#</a> 新版生命周期</h3><p><strong>React &gt;= 16.0.0</strong><img src="/vuepress_blog/assets/2-664f2acd.png" alt="image.png"> 主要变化在挂载阶段和更新阶段</p><ul><li>挂载阶段变化 <ul><li>移除可能会多次运行的 componentWillMount 函数</li><li>增加 getDerivedStateFromProps 函数</li></ul></li><li>更新阶段变化 <ul><li>移除容易出问题的 componentWillReceiveProps 函数 <ul><li>反模式行为 <ul><li>子组件状态初始值是父组件传递的属性值</li><li>政正常来说子组件状态的值只能在子组件修改</li><li>但是父组件中修改属性值后，可以通过 componentWillReceiveProps 函数，在子组件内监控属性值的变化，然后调用 setState 修改状态值</li><li>非常容易造成 bug</li><li>数据应该和状态或属性保持一致，数据来源必须是单一的，这样与 React 的模式相反</li></ul></li></ul></li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span><span class="token parameter">nextProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">number</span><span class="token operator">:</span> nextProps<span class="token punctuation">.</span>number
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>增加 getDerivedStateFromProps 函数</li><li>属性和状态变化后都是直接运行 getDerivedStateFromProps 函数</li><li>移除没啥用的 componentWillUpdate 函数</li><li>增加 getSnapshotBeforeUpdate 函数，在 render 之后挂载完成之前运行</li></ul><p>React官方认为，某个数据的来源必须是单一的</p><ol><li>getDerivedStateFromProps 获取更新的属性和状态 <ol><li>两个参数，第一个是属性 props，第二个是状态 state</li><li>通过参数可以获取新的属性和状态</li><li>该函数是静态的，修改了 this 指向，指向 constructor 构造函数</li><li>该函数的必须得有返回值，且返回值会覆盖掉组件状态</li><li>该函数几乎没有什么用</li></ol></li><li>getSnapshotBeforeUpdate 获取挂载更新前的快照（属性和状态） <ol><li>真实的DOM构建完成，但还未实际渲染到页面中</li><li>在该函数中，通常用于实现一些附加的dom操作，比如添加一些动画或者控制什么的</li><li>该函数必须得有返回值，且返回值会作为 componentDidUpdate 的第三个参数</li><li>一般与 componentDidUpdate 函数联合使用</li></ol></li></ol><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 获取更新的属性和状态</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;getDerivedStateFromProps&quot;</span><span class="token punctuation">,</span> props<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> state<span class="token punctuation">;</span>
<span class="token punctuation">}</span> 
<span class="token function-variable function">getSnapshotBeforeUpdate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 获取即将挂载的dom的属性和状态</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;getSnapshotBeforeUpdate&quot;</span><span class="token punctuation">,</span> prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> <span class="token number">132</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>

 <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snap</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;componentDidUpdate&quot;</span><span class="token punctuation">,</span> prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snap<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="传递元素内容" tabindex="-1"><a class="header-anchor" href="#传递元素内容" aria-hidden="true">#</a> 传递元素内容</h2><p>内置组件：React定义好的组件，如：div、h1、p <code>&lt;div&gt;这是一个内置组件&lt;/div&gt;</code></p><ul><li>如果给自定义组件传递元素内容，可以当作属性传递</li><li>也可以放在标签内，React会将元素内容作为children属性传递过去，会忽略空白字符，如果只是空格或换行，没有其它内容，会被忽略，不会生成children属性</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token attr-name">html</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">一段内容</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">App</span></span><span class="token punctuation">&gt;</span></span> <span class="token comment">// 当作属性传递</span>
<span class="token comment">// ==================</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> 一段内容 </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">App</span></span><span class="token punctuation">&gt;</span></span> <span class="token comment">// 在标签内传递</span>
<span class="token comment">// 内容在组件内 props.children 属性里</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="表单" tabindex="-1"><a class="header-anchor" href="#表单" aria-hidden="true">#</a> 表单</h2><h3 id="受控组件和非受控组件" tabindex="-1"><a class="header-anchor" href="#受控组件和非受控组件" aria-hidden="true">#</a> 受控组件和非受控组件</h3><ul><li>受控组件：组件的使用者，有权力完全控制该组件的行为和内容 <ul><li>通常情况下，受控组件往往没有自身的状态，其内容完全收到属性的控制，比如函数组件</li></ul></li><li>非受控组件：组件的使用者，没有能力控制该组件的行为和内容，组件的行为和内容完全自行控制 <ul><li>比如完全受状态控制的类组件。</li></ul></li></ul><p><strong>表单组件，默认情况下是非受控组件，一旦设置了表单组件的 value 属性，则其变为受控组件(单选和多选框需要设置checked)</strong></p><ul><li>通过 onChange 事件进行数据控制</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">NumberInput</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span> <span class="token comment">// 只可以输入数字</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">val</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">checkChangeValue</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> val <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        val <span class="token operator">=</span> val<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\D</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">val</span><span class="token operator">:</span> val<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>
                    <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">}</span></span>
                    <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>checkChangeValue<span class="token punctuation">}</span></span>
                <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="属性默认值和类型检查" tabindex="-1"><a class="header-anchor" href="#属性默认值和类型检查" aria-hidden="true">#</a> 属性默认值和类型检查</h2><h3 id="属性默认值" tabindex="-1"><a class="header-anchor" href="#属性默认值" aria-hidden="true">#</a> 属性默认值</h3><p>通过一个静态属性 <strong>defaultProps</strong> 告知 React 属性默认值</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token function-variable function">FuncDefault</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            a: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text">, b: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>b<span class="token punctuation">}</span><span class="token plain-text">, c: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>c<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
FuncDefault<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 如果传递属性值会进行混合 Object.assign</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> FuncDefault
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">ClassDefault</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 在此阶段之前就会完成对默认属性的混合</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                a: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text">, b: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>b<span class="token punctuation">}</span><span class="token plain-text">, c: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>c<span class="token punctuation">}</span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
ClassDefault<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ClassDefault<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="属性类型检查" tabindex="-1"><a class="header-anchor" href="#属性类型检查" aria-hidden="true">#</a> 属性类型检查</h3><p>使用库：prop-types React 官方出品的库 对组件使用静态属性 propTypes 告知 React 如何检查属性</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code>PropTypes<span class="token punctuation">.</span>any：<span class="token comment">// 任意类型，常用来设置必填 PropTypes.any.isRequired</span>
PropTypes<span class="token punctuation">.</span>array：<span class="token comment">// 数组类型</span>
PropTypes<span class="token punctuation">.</span>bool：<span class="token comment">// 布尔类型</span>
PropTypes<span class="token punctuation">.</span>func：<span class="token comment">// 函数类型</span>
PropTypes<span class="token punctuation">.</span>number：<span class="token comment">// 数字类型</span>
PropTypes<span class="token punctuation">.</span>object：<span class="token comment">// 对象类型</span>
PropTypes<span class="token punctuation">.</span>string：<span class="token comment">// 字符串类型</span>
PropTypes<span class="token punctuation">.</span>symbol：<span class="token comment">// 符号类型</span>

PropTypes<span class="token punctuation">.</span>node：<span class="token comment">// 任何可以被渲染的内容，字符串、数字、React元素</span>
PropTypes<span class="token punctuation">.</span>element：<span class="token comment">// react元素</span>
PropTypes<span class="token punctuation">.</span>elementType：<span class="token comment">// react元素类型，可以用来传递组件，但是传递过来的组件需要先用一个变量接收，然后再使用，如：const comp = this.props.comp, &lt;comp /&gt;</span>
PropTypes<span class="token punctuation">.</span><span class="token function">instanceOf</span><span class="token punctuation">(</span>指定构造函数<span class="token punctuation">)</span>：<span class="token comment">// 必须是指定构造函数的实例</span>
PropTypes<span class="token punctuation">.</span><span class="token function">oneOf</span><span class="token punctuation">(</span><span class="token punctuation">[</span>xxx<span class="token punctuation">,</span> xxx<span class="token punctuation">]</span><span class="token punctuation">)</span>：<span class="token comment">// 枚举，传递的参数值必须的枚举值中的某一个</span>
PropTypes<span class="token punctuation">.</span><span class="token function">oneOfType</span><span class="token punctuation">(</span><span class="token punctuation">[</span>xxx<span class="token punctuation">,</span> xxx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 属性类型必须是数组中的其中一个</span>
PropTypes<span class="token punctuation">.</span><span class="token function">arrayOf</span><span class="token punctuation">(</span>PropTypes<span class="token punctuation">.</span><span class="token constant">XXX</span><span class="token punctuation">)</span>：<span class="token comment">// 必须是某一类型数据组成的数组</span>
PropTypes<span class="token punctuation">.</span><span class="token function">objectOf</span><span class="token punctuation">(</span>PropTypes<span class="token punctuation">.</span><span class="token constant">XXX</span><span class="token punctuation">)</span>：<span class="token comment">// 对象由某一类型的值组成</span>
PropTypes<span class="token punctuation">.</span><span class="token function">shape</span><span class="token punctuation">(</span>对象<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token comment">// 属性必须是对象，并且满足指定的对象要求，针对对象中的每一个属性进行检查，且在对象中可以嵌套使用</span>
PropTypes<span class="token punctuation">.</span><span class="token function">exact</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>：<span class="token comment">// 对象必须精确匹配传递的数据，完全精确匹配，属性不能多</span>

<span class="token comment">// 自定义属性检查，如果有错误，返回错误对象即可</span>
<span class="token function-variable function">属性</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> propName<span class="token punctuation">,</span> componentName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">&#39;prop-types&#39;</span>
<span class="token keyword">class</span> <span class="token class-name">ValidationComp</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> propTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 类组件用法</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span> <span class="token comment">// a属性必须是一个数字类型且必填</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ValidationComp<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">&#39;prop-types&#39;</span>
<span class="token keyword">const</span> <span class="token function-variable function">FuncDefault</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            a: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text">, b: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>b<span class="token punctuation">}</span><span class="token plain-text">, c: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>c<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
FuncDefault<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 函数组件用法</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> FuncDefault
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="hoc-高阶组件" tabindex="-1"><a class="header-anchor" href="#hoc-高阶组件" aria-hidden="true">#</a> HOC 高阶组件</h2><ul><li>HOF：Higher-Order Function，高阶函数， <ul><li>狭义上：以函数作为参数，并返回一个函数</li></ul></li><li>HOC: Higher-Order Component，高阶组件 <ul><li>本质上就是高阶函数，以组件作为参数，并返回一个组件</li></ul></li></ul><p><strong>通常，可以利用HOC实现横切关注点</strong> 举例：</p><ul><li>20个组件，每个组件在创建组件和销毁组件时，需要作日志记录</li><li>20个组件，它们需要显示一些内容，得到的数据结构完全一致</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">WithLog</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Comp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">LogWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
        <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;日志组件创建&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> WithLog<span class="token punctuation">;</span>
<span class="token comment">// ========== 使用</span>
<span class="token keyword">import</span> Comp <span class="token keyword">from</span> <span class="token string">&quot;./component/Comp&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> withLog <span class="token keyword">from</span> <span class="token string">&quot;./HOC/withLog&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> VComp <span class="token operator">=</span> <span class="token function">withLog</span><span class="token punctuation">(</span>Comp<span class="token punctuation">)</span><span class="token punctuation">;</span>
VComp <span class="token operator">=</span> <span class="token function">withLog</span><span class="token punctuation">(</span>VComp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 你甚至可以重复使用或者使用其他的高阶组件，但请不要无意义的重复使用，在此仅作为演示</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">VComp</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>注意</strong></p><ul><li>命名通常以 with 开头<code>withTest.jsx</code></li><li>不要在render中使用高阶组件，会销毁重建，浪费效率</li><li>不要在高阶组件内部更改传入的组件，容易出现问题并不方便维护</li></ul><h2 id="ref" tabindex="-1"><a class="header-anchor" href="#ref" aria-hidden="true">#</a> ref</h2><h3 id="reference-引用" tabindex="-1"><a class="header-anchor" href="#reference-引用" aria-hidden="true">#</a> reference: 引用</h3><p>和vue中的ref类似</p><ul><li>场景：希望直接使用dom元素中的某个方法，或者希望直接使用自定义组件中的某个方法 <ul><li>ref作用于内置的html组件，得到的将是真实的dom对象</li><li>ref作用于类组件，得到的将是类的实例，作用于函数组件，将报错</li><li>ref不能作用于函数组件，函数组件里可以使用ref，但只能在组件内部用</li></ul></li><li>ref不再推荐使用字符串赋值，字符串赋值的方式将来可能会被移出</li><li>目前，ref推荐使用对象或者是函数赋值 <ul><li>使用对象 <ul><li>通过 React.createRef 函数创建，一般会在构造函数中先创建好，创建出来的对象是<code>{ current: null }</code>，可以直接将该对象赋值给ref，起作用，真实的 dom 会保存到 current 上 <ul><li><code>this.txtRef = React.createRef() &lt;input ref = {this.txtRef} type = &#39;text&#39; /&gt;</code></li><li>调用方法：<code>this.txt.current.focus()</code>使用内置的 current 属性调用</li></ul></li></ul></li><li>使用函数 <ul><li>创建方法：<code>&lt;input ref = {el =&gt; { this.txt = el }} type = &#39;text&#39; /&gt;</code></li><li>使用方法：<code>this.txt.focus()</code></li><li>ref 函数的调用时间： <ul><li>componentDidMount 的时候会调用该函数 <ul><li>在 componentDidMount 事件中可以使用 ref</li></ul></li><li>如果 ref 的值发生了变动（旧的函数被新的函数替代），分别调用旧的函数以及新的函数，时间点出现在 componentDidUpdate 之前 <ul><li>旧的函数被调用时，传递 null，移除之前函数绑定的 dom</li><li>新的函数被调用时，传递对象，创建新的 dom 绑定</li></ul></li><li>如果ref所在的组件被卸载，会调用函数，传递 null</li></ul></li></ul></li></ul></li><li>ref 是一个 React 关键字，不是属性</li></ul><h3 id="谨慎使用ref" tabindex="-1"><a class="header-anchor" href="#谨慎使用ref" aria-hidden="true">#</a> 谨慎使用ref</h3><p>能够使用属性和状态进行控制，就不要使用 ref，ref 实际上是反模式</p><ul><li>调用真实的 DOM 对象中的方法</li><li>某个时候需要调用类组件的方法</li></ul><h2 id="ref转发" tabindex="-1"><a class="header-anchor" href="#ref转发" aria-hidden="true">#</a> Ref转发</h2><h3 id="forwardref方法" tabindex="-1"><a class="header-anchor" href="#forwardref方法" aria-hidden="true">#</a> forwardRef方法</h3><ul><li>可以认为是一个高阶组件</li><li>参数 <ul><li>一个函数组件，不能是类组件</li><li>函数组件需要有第二个参数来得到ref</li></ul></li><li>返回值，返回一个新的组件</li></ul><h4 id="用法" tabindex="-1"><a class="header-anchor" href="#用法" aria-hidden="true">#</a> 用法</h4><ul><li>给函数组件绑定 ref</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">FuncDefault</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            a: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text">, b: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>b<span class="token punctuation">}</span><span class="token plain-text">, c: </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>c<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span>FuncDefault<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在高阶组件中做 ref 转发</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">WithLog</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Comp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">LogWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
        <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;日志组件创建&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> forwardRef<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>forwardRef<span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>rest<span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">LogWrapper</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> <span class="token attr-name">forwardRef</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> WithLog<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="context" tabindex="-1"><a class="header-anchor" href="#context" aria-hidden="true">#</a> Context</h2><p><strong>上下文：Context，表示做某一些事情的环境</strong></p><h3 id="react中的上下文特点" tabindex="-1"><a class="header-anchor" href="#react中的上下文特点" aria-hidden="true">#</a> React中的上下文特点</h3><ul><li>当某个组件创建了上下文后，上下文中的数据，会被所有后代组件共享</li><li>如果某个组件依赖了上下文，会导致该组件不再纯粹（外部数据仅来源于属性props）</li><li>一般情况下，用于第三方组件（通用组件）</li></ul><h3 id="旧的api-版本-16-0" tabindex="-1"><a class="header-anchor" href="#旧的api-版本-16-0" aria-hidden="true">#</a> 旧的API 版本 &lt; 16.0</h3><h4 id="创建上下文" tabindex="-1"><a class="header-anchor" href="#创建上下文" aria-hidden="true">#</a> 创建上下文</h4><p>只有类组件才可以创建上下文</p><ul><li>给类组件书写静态属性 childContextTypes，使用该属性对上下文中的数据类型进行约束</li><li>添加实例方法 getChildContext，该方法返回的对象，即为上下文中的数据，该数据必须满足类型约束 <ul><li>该方法会在每次render之后运行。</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code>   <span class="token keyword">static</span> childContextTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 静态属性，约束上下文的数据类型</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
        <span class="token literal-property property">b</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 实例方法，得到上下文的数据</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="使用上下文中的数据" tabindex="-1"><a class="header-anchor" href="#使用上下文中的数据" aria-hidden="true">#</a> 使用上下文中的数据</h4><p>要求：如果要使用上下文中的数据，组件必须有一个静态属性 contextTypes，该属性描述了需要获取的上下文中的数据类型</p><ul><li>可以在组件的构造函数中，通过第二个参数，获取上下文数据</li><li><strong>从组件的context属性中获取</strong></li><li>在函数组件中，通过第二个参数，获取上下文数据</li><li>类似与作用域链，采取就近原则，上下文属性名相近取最近的值</li></ul><h4 id="上下文的数据变化" tabindex="-1"><a class="header-anchor" href="#上下文的数据变化" aria-hidden="true">#</a> 上下文的数据变化</h4><ul><li>上下文中的数据不可以直接变化，最终都是通过状态改变</li><li>在上下文中加入一个处理函数，可以用于后代组件更改上下文的数据 <ul><li>后代组件调用上下文中的函数更改上下文中的数据，也是修改父组件的状态来改变的</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">&#39;prop-types&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">GetFuncOldContext</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                GetFuncOldContext 获取的上下文数据
                a: </span><span class="token punctuation">{</span>context<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* a: 1 */</span><span class="token punctuation">}</span><span class="token plain-text">
                c: </span><span class="token punctuation">{</span>context<span class="token punctuation">.</span>c<span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* c: 2 */</span><span class="token punctuation">}</span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
GetFuncOldContext<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 函数组件调用 contextTypes 的方法</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
    <span class="token literal-property property">c</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">GetOldClassContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 约束要获取的上下文的数据类型，约束谁能获取谁，防止滥用</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> childContextTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 静态属性，约束上下文的数据类型</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span> <span class="token comment">// 可以重写，但类型一定要一样，且在当前上下文中获取的父级的a仍然是父级的</span>
        <span class="token literal-property property">c</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
        <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 实例方法，得到上下文的数据</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>c<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// constructor(props, context) {</span>
    <span class="token comment">//     super(props);</span>
    <span class="token comment">//     console.log(context) // { a: 1 }</span>
    <span class="token comment">// }</span>
    <span class="token comment">// constructor(props, context) { // 可以不写</span>
    <span class="token comment">//     super(props, context);</span>
    <span class="token comment">//     console.log(this.context) // { a: 1 }</span>
    <span class="token comment">// }</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    GetOldClassContext获取的上下文数据
                    a: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* a: 1 */</span><span class="token punctuation">}</span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GetFuncOldContext</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">OldContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 约束要获取的上下文的数据类型，约束谁能获取谁，防止滥用</span>
        <span class="token literal-property property">c</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> childContextTypes <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token comment">// 静态属性，约束上下文的数据类型</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">,</span>
        <span class="token literal-property property">b</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span>
    <span class="token punctuation">}</span>
    <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 实例方法，得到上下文的数据</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token punctuation">,</span>
            <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>b
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    OldContext获取的上下文数据
                    c: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>c<span class="token punctuation">}</span><span class="token plain-text">  </span><span class="token punctuation">{</span><span class="token comment">/* 获取不到 c，父不能获取子的上下文数据 */</span><span class="token punctuation">}</span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">GetOldClassContext</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> OldContext<span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="新版api-版本-16-0" tabindex="-1"><a class="header-anchor" href="#新版api-版本-16-0" aria-hidden="true">#</a> 新版API 版本 &gt; 16.0</h3><p>旧版API存在严重的效率问题，并且容易导致滥用</p><h4 id="创建上下文-1" tabindex="-1"><a class="header-anchor" href="#创建上下文-1" aria-hidden="true">#</a> 创建上下文</h4><p>上下文是一个独立于组件的对象，该对象<strong>通过 React.createContext(默认值) 创建</strong>，返回的是一个包含两个属性的对象</p><ul><li>Provider属性：上下文生产者 <ul><li>一个组件，该组件会创建一个上下文，该组件有一个value属性，通过该属性，可以为其数据赋值 <ul><li>可以为 value 赋值为 state 中的一个对象引用，不修改对象引用地址时，可以在上下文数据改变的时候进入 shouldComponentUpdate 来做优化</li></ul></li><li>同一个Provider，不要用到多个组件中，如果需要在其他组件中使用该数据，应该考虑将数据提升到更高的层次，或者使用 **React.createContext() **重新创建一个上下文</li></ul></li><li>Consumer属性：上下文的消费者 <ul><li>一个组件，用来获取上下文</li></ul></li></ul><h4 id="使用上下文中的数据-1" tabindex="-1"><a class="header-anchor" href="#使用上下文中的数据-1" aria-hidden="true">#</a> 使用上下文中的数据</h4><ul><li>在类组件中，直接使用 this.context 获取上下文数据，也可以使用 Consumer 来获取 <ul><li>要求：必须拥有静态属性 contextType , 应赋值为创建的上下文对象</li></ul></li><li>在函数组件中，需要使用 Consumer 来获取上下文数据 <ul><li>Consumer是一个组件</li><li>它的子节点，是一个函数（它的props.children需要传递一个函数）</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">FuncNewContext</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            FuncNewContext
            来自上下文的数据
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> // 获取上下文中的数据，子节点需要传一个函数，参数就是上下文的数据对象
                    </span><span class="token punctuation">{</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">a: </span><span class="token punctuation">{</span>value<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text">, b: </span><span class="token punctuation">{</span>value<span class="token punctuation">.</span>b<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ClassNewContext</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ClassNewContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> contextType <span class="token operator">=</span> ctx<span class="token punctuation">;</span> <span class="token comment">// 获取上下文的数据，放如 this.context 里</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                ClassNewContext
                来自上下文的数据：a: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text">, b: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>b<span class="token punctuation">}</span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">// 获取上下文中的数据，子节点需要传一个函数，参数就是上下文的数据对象
                    </span><span class="token punctuation">{</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">a: </span><span class="token punctuation">{</span>value<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token plain-text">, b: </span><span class="token punctuation">{</span>value<span class="token punctuation">.</span>b<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">NewContext</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">d</span><span class="token operator">:</span> <span class="token string">&#39;f&#39;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> // 进行上下文的赋值，如果赋值为 state 中的对象引用(比如 this.state.c)，不修改c时，可以避免强制渲染
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">FuncNewContext</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx.Provider</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> NewContext<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="注意" tabindex="-1"><a class="header-anchor" href="#注意" aria-hidden="true">#</a> 注意</h4><p>如果，上下文提供者（Context.Provider）中的value属性发生变化(Object.is比较)，会导致该上下文提供的所有后代元素全部重新渲染（强制渲染），无论该子元素是否有优化（无论 shouldComponentUpdate 函数返回什么结果）</p><h3 id="上下文的应用场景" tabindex="-1"><a class="header-anchor" href="#上下文的应用场景" aria-hidden="true">#</a> 上下文的应用场景</h3><p>一般在我们自己开发编写一套组件（有多个组件），这些组件之间需要相互配合才能最终完成功能，才会用到上下文，用别人的组件的时候一般用不到，比如，我们要开发一套表单组件，使用方式如下：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form</span></span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">datas</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取表单中的所有数据（对象）</span>
            <span class="token comment">/*
                {
                    loginId:xxxx,
                    loginPwd:xxxx
                }
            */</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
               账号： </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form.Input</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loginId<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
               密码： </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form.Input</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loginPwd<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Form.Button</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">提交</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Form.Button</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Form</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="purecomponent-纯组件" tabindex="-1"><a class="header-anchor" href="#purecomponent-纯组件" aria-hidden="true">#</a> PureComponent 纯组件</h2><ul><li>纯组件，只在需要重新渲染的时候重新渲染，用于避免不必要的渲染（运行 render 函数），从而提高效率</li><li>优化：如果一个组件的属性和状态都没有发生变化，重新渲染该组件是没有必要的</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> nextState<span class="token punctuation">,</span> nextContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ObjectEqual</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span> nextProps<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ObjectEqual</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ================</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">ObjectEqual</span><span class="token punctuation">(</span><span class="token parameter">obj1<span class="token punctuation">,</span> obj2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> prop <span class="token keyword">in</span> obj1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Object<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>obj1<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">,</span> obj2<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>PureComponent 是一个组件，如果某个组件继承自该组件，则该组件的 shouldComponentUpdate 会进行优化，对属性和状态进行浅比较，如果相等，则不会重新渲染</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>PureComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ClassDefault</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span> <span class="token comment">// 继承 PureComponent 就行</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
           
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ClassDefault<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="注意-1" tabindex="-1"><a class="header-anchor" href="#注意-1" aria-hidden="true">#</a> 注意</h3><ul><li>为了效率，能用 PureComponent 尽量用</li><li>PureComponent 进行的是浅比较 <ul><li>要求不要改动之前的状态，永远是使用新的状态覆盖之前的状态，保证每次都是更新的状态（Immutable，不可变对象） <ul><li>对象可以这样赋值 <code>this.setState({ obj: { ...this.state.obj, b: 50 } }</code></li><li>这样 obj 内的 b 属性就会被重新赋值，其他属性不变</li><li>或者使用<code>Object.assign({}, this.state.obj, { b: 50 })</code></li><li>Immutable.js ：一个第三方 js 库，专门用于制作不可变对象</li></ul></li></ul></li></ul><h2 id="react-memo-组件-内置高阶函数" tabindex="-1"><a class="header-anchor" href="#react-memo-组件-内置高阶函数" aria-hidden="true">#</a> React.memo(组件) 内置高阶函数</h2><ul><li>函数组件优化使用该函数处理一下就好了，返回的是一个类组件，可以认为是高阶组件</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">FuncDefault</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span>FuncDefault<span class="token punctuation">)</span> <span class="token comment">// 处理一下就好</span>
<span class="token comment">// =======</span>
<span class="token keyword">function</span> <span class="token function">memo</span><span class="token punctuation">(</span><span class="token parameter">FuncComp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// memo 模拟</span>
    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">Memo</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">FuncComp</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
            <span class="token comment">// or return &lt;&gt; {FuncComp(this.props)} &lt;/&gt;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="render-props-重复代码优化" tabindex="-1"><a class="header-anchor" href="#render-props-重复代码优化" aria-hidden="true">#</a> render props 重复代码优化</h2><p>有时候，某些组件的各种功能及其处理逻辑几乎完全相同，只是显示的界面不一样，建议下面的方式认选其一来解决重复代码的问题（横切关注点）</p><ul><li>render props <ul><li>某个组件，需要某个属性</li><li>该属性是一个函数，函数的返回值用于渲染</li><li>函数的参数会传递为需要的数据</li><li>注意纯组件的属性（尽量避免每次传递的render props的地址不一致）</li><li>通常该属性的名字叫做render</li></ul></li><li>HOC 高阶组件 <ul><li>更加具有通用性</li></ul></li></ul><h2 id="portals-插槽" tabindex="-1"><a class="header-anchor" href="#portals-插槽" aria-hidden="true">#</a> Portals 插槽</h2><ul><li>插槽：将一个React元素渲染到指定的DOM容器中 <ul><li>也就是可以不渲染到默认的 #root div 中，你指定哪个就渲染到哪个里</li><li>但是会有事件冒泡问题，需要注意</li></ul></li><li>ReactDOM.createPortal(React元素, 真实的DOM容器)，该函数返回一个React元素</li></ul><h3 id="注意事件冒泡" tabindex="-1"><a class="header-anchor" href="#注意事件冒泡" aria-hidden="true">#</a> 注意事件冒泡</h3><ul><li>React中的事件是包装过的</li><li>它的事件冒泡是根据虚拟DOM树来冒泡的，与真实的DOM树无关</li></ul><h2 id="错误边界" tabindex="-1"><a class="header-anchor" href="#错误边界" aria-hidden="true">#</a> 错误边界</h2><p>默认情况下，若一个组件在<strong>渲染期间</strong>（render）发生错误，会导致整个组件树全部被卸载</p><h3 id="错误边界-需要自己写" tabindex="-1"><a class="header-anchor" href="#错误边界-需要自己写" aria-hidden="true">#</a> 错误边界 需要自己写</h3><p>是一个组件，<strong>该组件会捕获到渲染期间（render）子组件发生的错误</strong>，<strong>并有能力阻止错误继续传播</strong></p><h3 id="让某个组件捕获错误" tabindex="-1"><a class="header-anchor" href="#让某个组件捕获错误" aria-hidden="true">#</a> 让某个组件捕获错误</h3><ul><li>编写生命周期函数 getDerivedStateFromError <ul><li>静态函数</li><li>运行时间点：渲染子组件的过程中，发生错误之后，在更新页面之前</li><li><strong>注意：只有子组件发生错误，才会运行该函数</strong></li><li>该函数返回一个对象，React会使用该对象的属性覆盖掉当前组件的state</li><li>参数：错误对象</li><li>通常，该函数用于改变状态</li></ul></li><li>编写生命周期函数 componentDidCatch <ul><li>实例方法</li><li>运行时间点：渲染子组件的过程中，发生错误，更新页面之后，由于其运行时间点比较靠后，因此不太会在该函数中改变状态</li><li>通常，该函数用于记录错误消息</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span>PureComponent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ErrorBound</span> <span class="token keyword">extends</span> <span class="token class-name">PureComponent</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hasError</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token function">getDerivedStateFromError</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 捕获错误信息</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">hasError</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 覆盖 state</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">componentDidCatch</span><span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> errorInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 捕获错误信息</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;记录错误信息&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">,</span> errorInfo<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>hasError<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">发生错误了</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">;</span> <span class="token comment">// 穿过来的 children 内如果出现错误，会执行上边的代码</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ErrorBound<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="注意-2" tabindex="-1"><a class="header-anchor" href="#注意-2" aria-hidden="true">#</a> 注意</h3><p>某些错误，错误边界组件无法捕获</p><ul><li>自身的错误</li><li>异步的错误</li><li>事件中的错误</li><li>以上错误自行使用 <code>try{} cacth(e)</code>处理</li></ul><p>总结：仅处理渲染子组件期间的同步错误</p><h2 id="react中的事件" tabindex="-1"><a class="header-anchor" href="#react中的事件" aria-hidden="true">#</a> React中的事件</h2><p>这里的事件：React 内置的 DOM 组件中的事件</p><ul><li>给 document 注册事件</li><li>几乎所有的元素的事件处理，均在 document 的事件中处理 <ul><li>一些不冒泡的事件，是直接在元素上监听</li><li>一些 document 上面没有的事件，直接在元素上监听</li></ul></li><li>在 document 的事件处理，React 会根据虚拟 DOM 树的完成事件函数的调用</li><li>React 的事件参数，并非真实的 DOM 事件参数，是 React 合成的一个对象，该对象类似于真实 DOM的事件参数 <ul><li>stopPropagation，阻止事件在虚拟DOM树中冒泡</li><li>nativeEvent，可以得到真实的DOM事件对象</li><li>为了提高执行效率，React使用事件对象池来处理事件对象</li></ul></li></ul><h3 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项" aria-hidden="true">#</a> 注意事项</h3><ul><li>如果给真实的 DOM 注册事件，阻止了事件冒泡，则会导致 react 的相应事件无法触发</li><li>如果给真实的 DOM 注册事件，事件会先于React事件运行</li><li>通过 React 的事件中阻止事件冒泡，无法阻止真实的 DOM 事件冒泡</li><li>可以通过 nativeEvent.stopImmediatePropagation()，阻止 document 上剩余事件的执行</li><li>在事件处理程序中，不要异步的使用事件对象，如果一定要使用，需要调用 persist 函数持久保留函数</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">StopPropagation</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;react：div被点击了&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 冒泡被阻止</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;react: 按钮被点击了&#39;</span><span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>nativeEvent<span class="token punctuation">)</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">isPropagationStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 阻止冒泡的判断函数</span>
                e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 阻止冒泡</span>
                <span class="token comment">// e.nativeEvent.stopImmediatePropagation() // 阻止 document 上剩余事件的执行</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">isPropagationStopped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">按钮</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 不能被阻止</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;真实的dom事件被：id 为 root 的 div 被点击了&#39;</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span><span class="token function">stopImmediatePropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 阻止 document 上剩余事件的执行，且导致 react 的相应事件无法触发</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;document被点击了&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> StopPropagation<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="渲染原理-超级重要-️" tabindex="-1"><a class="header-anchor" href="#渲染原理-超级重要-️" aria-hidden="true">#</a> 渲染原理（超级重要‼️）</h2><p>渲染：生成用于显示的对象，以及将这些对象形成真实的DOM对象</p><ul><li>React元素：React Element，通过 React.createElement 创建（语法糖：JSX），例如： <ul><li><div><h1>标题</h1></div></li><li><!----></li></ul></li><li>React 节点：专门用于渲染到 UI 界面的对象，React 会通过 React 元素，创建 React 节点，ReactDOM 一定是通过 React 节点来进行渲染的</li><li>节点类型： <ul><li>React DOM 节点：创建该节点的 React 元素类型是一个字符串</li><li>React 组件节点：创建该节点的 React 元素类型是一个函数或是一个类</li><li>React 文本节点：由字符串、数字创建的，文本内容</li><li>React 空节点：由 null、undefined、false、true</li><li>React 数组节点：该节点由一个数组创建</li></ul></li><li>真实 DOM：通过 document.createElement 创建的 dom 元素</li></ul><p><img src="/vuepress_blog/assets/3-bd2fe745.png" alt="image.png"></p><h3 id="首次渲染-新节点渲染-render-虚拟元素-绑定的根结点" tabindex="-1"><a class="header-anchor" href="#首次渲染-新节点渲染-render-虚拟元素-绑定的根结点" aria-hidden="true">#</a> 首次渲染(新节点渲染) render(虚拟元素, 绑定的根结点)</h3><ol><li>通过参数的值创建节点</li><li>根据不同的节点，做不同的事情 <ul><li>文本节点：通过 document.createTextNode 创建真实的文本节点</li><li>空节点：什么都不做</li><li>数组节点：遍历数组，将数组每一项递归创建节点（回到第1步进行反复操作，直到遍历结束）</li><li>DOM 节点：通过 document.createElement 创建真实的DOM对象，然后立即设置该真实DOM元素的各种属性，然后遍历对应 React 元素的 children 属性，递归操作（回到第1步进行反复操作，直到遍历结束）</li><li>组件节点 <ul><li>函数组件：调用函数(该函数必须返回一个可以生成节点的内容)，将该函数的返回结果递归生成节点（回到第1步进行反复操作，直到遍历结束）</li><li>类组件： <ol><li>创建该类的实例</li><li>立即调用对象的生命周期方法：static getDerivedStateFromProps</li><li>运行该对象的 render 方法，拿到节点对象（将该节点递归操作，回到第1步进行反复操作）</li><li>将该组件的 componentDidMount 加入到执行队列（先进先出，先进先执行），当整个虚拟 DOM树 全部构建完毕，并且将真实的DOM对象加入到容器中后，执行该队列</li></ol></li></ul></li></ul></li><li>生成出虚拟 DOM 树之后，将该树保存起来，以便后续使用</li><li>将之前生成的真实的 DOM 对象，加入到容器中</li></ol><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>assaf<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        标题
        </span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">段落</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token keyword">undefined</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上代码生成的虚拟 DOM 树： <img src="/vuepress_blog/assets/4-40343f1f.png" alt="image.png"></p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Comp1</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Comp1 </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>n<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp1</span></span> <span class="token attr-name">n</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上代码生成的虚拟 DOM 树： <img src="/vuepress_blog/assets/5-3718a7a3.png" alt="image.png"></p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">Comp1</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Comp1</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp1</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">App</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以上代码生成的虚拟 DOM 树： <img src="/vuepress_blog/assets/6-049c14e8.png" alt="image.png"></p><h3 id="更新节点" tabindex="-1"><a class="header-anchor" href="#更新节点" aria-hidden="true">#</a> 更新节点</h3><h4 id="更新的场景" tabindex="-1"><a class="header-anchor" href="#更新的场景" aria-hidden="true">#</a> 更新的场景</h4><ul><li>重新调用 ReactDOM.render <ul><li>触发根节点更新</li></ul></li><li>在类组件的实例对象中调用 setState <ul><li>会导致该实例所在的节点更新</li></ul></li></ul><h4 id="节点的更新" tabindex="-1"><a class="header-anchor" href="#节点的更新" aria-hidden="true">#</a> 节点的更新</h4><ul><li>如果调用的是 ReactDOM.render，进入根节点的<strong>对比（diff）更新</strong></li><li>如果调用的是 setState <ol><li>运行生命周期函数，static getDerivedStateFromProps</li><li>运行 shouldComponentUpdate，如果该函数返回false，终止当前流程</li><li>运行 render，得到一个新的节点，进入该新的节点的<strong>对比更新</strong></li><li>将生命周期函数 getSnapshotBeforeUpdate 加入执行队列，以待将来执行</li><li>将生命周期函数 componentDidUpdate 加入执行队列，以待将来执行</li></ol></li></ul><h4 id="后续步骤" tabindex="-1"><a class="header-anchor" href="#后续步骤" aria-hidden="true">#</a> 后续步骤</h4><ol><li>更新虚拟 DOM 树</li><li>完成真实的DOM更新</li><li>依次调用执行队列中的 componentDidMount</li><li>依次调用执行队列中的 getSnapshotBeforeUpdate</li><li>依次调用执行队列中的 componentDidUpdate</li><li>依次调用执行队列中的 componentWillUnmount</li></ol><h3 id="对比更新" tabindex="-1"><a class="header-anchor" href="#对比更新" aria-hidden="true">#</a> 对比更新</h3><p>将新产生的节点，对比之前虚拟 DOM 中的节点，发现差异，完成更新</p><h4 id="对比之前-dom-树中哪个节点" tabindex="-1"><a class="header-anchor" href="#对比之前-dom-树中哪个节点" aria-hidden="true">#</a> 对比之前 DOM 树中哪个节点</h4><ul><li>React 为了提高对比效率，做出以下假设 <ul><li>假设节点不会出现层次的移动（对比时，直接找到旧树中对应位置的节点进行对比）</li><li>不同的节点类型会生成不同的结构 <ul><li>相同的节点类型：节点本身类型相同，如果是由React元素生成，type值还必须一致</li><li>其他的，都属于不相同的节点类型</li></ul></li><li>多个兄弟通过唯一标识（key）来确定对比的新节点 <ul><li><strong>key 值的作用：用于通过旧节点，寻找对应的新节点，如果某个旧节点有 key 值，则其更新时，会寻找相同层级中的相同 key 值的节点，进行对比，就是用来确定对比目标的</strong></li><li><strong>key 值应该在一个范围内唯一（兄弟节点中），并且应该保持稳定</strong></li><li><strong>key 值可以绑定到任何 React 元素和组件上</strong></li></ul></li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">标题</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp</span></span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>comp<span class="token punctuation">&#39;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isVisible <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isVisible<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">显示/隐藏</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Comp</span></span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>comp<span class="token punctuation">&#39;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isVisible <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isVisible<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">显示/隐藏</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="找到了对比的目标" tabindex="-1"><a class="header-anchor" href="#找到了对比的目标" aria-hidden="true">#</a> 找到了对比的目标</h4><p>判断<strong>节点类型</strong>是否一致</p><ul><li><strong>一致</strong><ul><li>根据不同的节点类型，做不同的事情</li><li>空节点：不做任何事情</li><li>DOM 节点 <ol><li>直接重用之前的真实 DOM 对象</li><li>将其属性的变化记录下来，以待将来统一完成更新（现在不会真正的变化）</li><li>遍历该新的 React 元素的子元素，递归对比更新</li></ol></li><li>文本节点 <ol><li>直接重用之前的真实 DOM 对象</li><li>将新的文本变化记录下来，将来统一完成更新</li></ol></li><li>组件节点 <ul><li>函数组件 <ol><li>直接重新调用函数，得到一个节点对象，进入递归对比更新</li></ol></li><li>类组件 <ol><li>直接重用之前的实例</li><li>调用生命周期方法 getDerivedStateFromProps</li><li>调用生命周期方法 shouldComponentUpdate，若该方法返回 false，终止</li><li>运行 render，得到新的节点对象，进入递归对比更新</li><li>将该对象的 getSnapshotBeforeUpdate 加入队列</li><li>将该对象的 componentDidUpdate 加入队列</li></ol></li></ul></li><li>数组节点 <ol><li>遍历数组进行递归对比更新</li></ol></li></ul></li><li><strong>不一致</strong></li></ul><p>整体上，卸载旧的节点，全新创建新的节点</p><ul><li><strong>先创建新节点</strong><ul><li>进入新节点的挂载流程</li></ul></li><li><strong>再卸载旧节点</strong><ul><li><strong>文本节点、DOM 节点、数组节点、空节点、函数组件节点</strong><ol><li>直接放弃该节点，如果节点有子节点，递归卸载节点</li></ol></li><li><strong>类组件节点</strong><ol><li>直接放弃该节点</li><li>调用该节点的 componentWillUnMount 函数</li><li>递归卸载子节点</li></ol></li></ul></li></ul><h4 id="没有找到对比的目标" tabindex="-1"><a class="header-anchor" href="#没有找到对比的目标" aria-hidden="true">#</a> 没有找到对比的目标</h4><p>新的 DOM 树中有节点被删除或者新的 DOM 树中有节点添加</p><ul><li>创建新加入的节点</li><li>卸载多余的旧节点</li></ul><h2 id="工具" tabindex="-1"><a class="header-anchor" href="#工具" aria-hidden="true">#</a> 工具</h2><h3 id="严格模式" tabindex="-1"><a class="header-anchor" href="#严格模式" aria-hidden="true">#</a> 严格模式</h3><h4 id="strictmode-react-strictmode" tabindex="-1"><a class="header-anchor" href="#strictmode-react-strictmode" aria-hidden="true">#</a> StrictMode <code>React.StrictMode</code></h4><p>本质是一个组件，该组件不进行UI渲染（像空标签：React.Fragment &lt;&gt; &lt;/&gt;），它的作用是，在渲染内部组件时，发现不合适的代码。</p><ul><li>识别不安全的生命周期</li><li>关于使用过时字符串 ref API 的警告</li><li>关于使用废弃的 findDOMNode 方法的警告</li><li>检测意外的副作用 <ul><li>React要求，副作用代码仅能出现在以下生命周期函数中 <ul><li>ComponentDidMount</li><li>ComponentDidUpdate</li><li>ComponentWillUnMount</li></ul></li></ul></li></ul><p>**副作用：**一个函数中，做了一些会影响函数外部数据的事情，例如：</p><ul><li>异步处理</li><li>改变参数值</li><li>改变状态，setState</li><li>本地存储</li><li>改变函数外部的变量，闭包等</li></ul><p><strong>相反的，如果一个函数没有副作用，则可以认为该函数是一个纯函数</strong> 在严格模式下，虽然不能监控到具体的副作用代码，但它会将不能具有副作用的函数调用两遍，以便发现问题（这种情况，仅在开发模式下有效）</p><ul><li>检测过时的 context API</li></ul><h3 id="profiler" tabindex="-1"><a class="header-anchor" href="#profiler" aria-hidden="true">#</a> Profiler</h3><p>性能分析工具，浏览器插件 分析某一次或多次提交（更新），涉及到的组件的渲染时间</p><ul><li>火焰图：得到某一次提交，每个组件总的渲染时间以及自身的渲染时间</li><li>排序图：得到某一次提交，每个组件自身渲染时间的排序</li><li>组件图：某一个组件，在多次提交中，自身渲染花费的时间</li></ul><p>点击录制进行录制，然后进行操作，操作完再结束录制，查看效率 <img src="/vuepress_blog/assets/7-daefe109.png" alt="image.png"></p><h2 id="hook" tabindex="-1"><a class="header-anchor" href="#hook" aria-hidden="true">#</a> HOOK</h2><p>HOOK是React16.8.0之后出现 组件：无状态组件（函数组件）、类组件 类组件中的麻烦：</p><ul><li>this指向问题</li><li>繁琐的生命周期</li><li>其他问题</li></ul><p>HOOK专门用于增强函数组件的功能（HOOK在类组件中是不能使用的），使之理论上可以成为类组件的替代品 **官方强调：**没有必要更改已经完成的类组件，官方目前没有计划取消类组件，只是鼓励使用函数组件 <strong>HOOK（钩子）本质上是一个函数(命名上总是以use开头)，该函数可以挂载任何功能，会在适当的时候执行这些功能</strong> HOOK种类：</p><ul><li>useState</li><li>useEffect</li><li>其他...</li></ul><h3 id="state-hook" tabindex="-1"><a class="header-anchor" href="#state-hook" aria-hidden="true">#</a> State Hook</h3><p>State Hook 是一个在函数组件中使用的函数（useState），用于在函数组件中使用状态</p><h4 id="usestate" tabindex="-1"><a class="header-anchor" href="#usestate" aria-hidden="true">#</a> useState</h4><ul><li>函数有一个参数，这个参数的值表示状态的默认值</li><li><strong>函数的返回值是一个数组，该数组一定包含两项</strong><ul><li><strong>第一项：当前状态的值</strong></li><li><strong>第二项：改变状态的函数，参数是改变的值</strong></li></ul></li></ul><p><strong>一个函数组件中可以有多个状态，这种做法非常有利于横向切分关注点</strong></p><ul><li>每个组件都有一个状态数组，该状态数组是跟节点绑定的</li><li>每次调用 useState 都会检查状态数组中该状态是否存在，如调用 N 次</li><li>不存在 <ul><li>使用默认值创建一个状态</li><li>将该状态加入到默认状态数组中，下标为 N</li></ul></li><li>存在 <ul><li>忽略掉默认值</li><li>直接得到状态值</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">TestOneHook</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// const arr = useState(0); // 使用一个状态，该状态的默认值是0</span>
    <span class="token comment">// const n = arr[0]; // 得到状态的值</span>
    <span class="token comment">// const setN = arr[1]; // 得到一个函数，该函数用于改变状态</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用一个状态，该默认值是0</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>visible<span class="token punctuation">,</span> setVisible<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用一个状态，该默认值是true</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">display</span><span class="token operator">:</span> visible <span class="token operator">?</span> <span class="token string">&#39;block&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;none&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">-</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">+</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token operator">!</span>visible<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">显示/隐藏</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> TestOneHook<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="注意-3" tabindex="-1"><a class="header-anchor" href="#注意-3" aria-hidden="true">#</a> 注意</h4><ul><li>useState 最好写到函数的起始位置，便于阅读</li><li>useState 严禁出现在代码块（判断、循环）中</li><li>useState 返回的函数（数组的第二项），引用不变（节约内存空间）</li><li>使用函数改变数据，若数据和之前的数据完全相等（使用 Object.is 比较），不会导致重新渲染，以达到优化效率的目的</li><li>使用函数改变数据，传入的值不会和原来的数据进行合并，而是直接替换</li><li>如果要实现强制刷新组件 <ul><li>类组件：使用 forceUpdate 函数 <ul><li><code>this.forceUpdate() // 强制重新渲染</code></li></ul></li><li>函数组件：使用一个状态为空对象的 useState <ul><li><code>const [, setN] = useState({}) // setN({}) 每次调用都是对象地址引用的修改，会导致重新渲染</code></li></ul></li></ul></li><li><strong>如果某些状态之间没有必然的联系，应该分化为不同的状态，而不要合并成一个对象</strong></li><li>和类组件的状态一样，函数组件中改变状态可能是异步的（在 DOM 事件中），多个状态变化会合并以提高效率，此时，不能信任之前的状态，而应该使用回调函数的方式改变状态。如果状态变化要使用到之前的状态，尽量传递函数。</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// setN(n + 1) // 不会立即改变，事件运行之后一起改变</span>
    <span class="token comment">// setN(n + 1) // 此时， n的值仍然是0</span>
    <span class="token function">setN</span><span class="token punctuation">(</span><span class="token parameter">prevN</span> <span class="token operator">=&gt;</span> prevN <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 传入的函数，在事件完成之后统一运行</span>
    <span class="token function">setN</span><span class="token punctuation">(</span><span class="token parameter">prevN</span> <span class="token operator">=&gt;</span> prevN <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">+</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="effect-hook" tabindex="-1"><a class="header-anchor" href="#effect-hook" aria-hidden="true">#</a> Effect Hook</h3><ul><li>Effect Hook：用于在函数组件中处理副作用</li></ul><p>副作用：</p><ul><li>ajax请求</li><li>计时器</li><li>其他异步操作</li><li>更改真实DOM对象</li><li>本地存储</li><li>其他会对外部产生影响的操作</li><li>函数：useEffect，该函数接收一个函数作为参数，接收的函数就是需要进行副作用操作的函数</li></ul><h4 id="注意-4" tabindex="-1"><a class="header-anchor" href="#注意-4" aria-hidden="true">#</a> 注意</h4><ul><li>副作用函数的运行时间点，是在页面完成真实的UI渲染之后。因此它的执行是异步的，并且不会阻塞浏览器 <ul><li>与类组件中 componentDidMount 和 componentDidUpdate 的区别 <ul><li>componentDidMount 和 componentDidUpdate，更改了真实DOM后马上运行，但是用户还没有看到 UI 更新，同步的</li></ul></li><li>useEffect 中的副作用函数，更改了真实 DOM，并且用户已经看到了 UI 更新后才执行，异步的</li></ul></li><li>每个函数组件中，可以多次使用useEffect，但不要放入判断或循环等代码块中 <ul><li>原理参看 useState</li></ul></li><li>useEffect 中的副作用函数，可以有返回值，返回值必须是一个函数，该函数叫做清理函数 <ul><li>该清理函数运行时间点，在每次运行副作用函数之前</li><li>首次渲染组件不会运行</li><li>组件被销毁时一定会运行</li></ul></li><li>useEffect 函数，可以传递第二个参数 <ul><li>第二个参数是一个数组</li><li>数组中记录该副作用的依赖数据</li><li>当组件重新渲染后，只有依赖数据与上一次不一样时，才会执行副作用</li><li>所以，当传递了依赖数据之后，如果数据没有发生变化 <ul><li>副作用函数仅在第一次渲染后运行</li><li>清理函数仅在卸载组件后运行</li></ul></li></ul></li><li>副作用函数中，如果使用了函数上下文中的变量，则由于闭包的影响，会导致副作用函数中变量不会实时变化</li><li>副作用函数在每次注册时，会覆盖掉之前的副作用函数，因此，尽量保持副作用函数稳定，否则控制起来会比较复杂</li></ul><h3 id="自定义hook" tabindex="-1"><a class="header-anchor" href="#自定义hook" aria-hidden="true">#</a> 自定义Hook</h3><p>自定义 Hook：将一些常用的、跨越多个组件的 Hook 功能，抽离出去形成一个函数，该函数就是自定义 Hook，自定义 Hook，由于其内部需要使用 Hook 功能，所以它本身也需要按照 Hook 的规则实现：</p><ul><li>函数名必须以 use 开头</li><li>调用自定义 Hook 函数时，应该放到顶层</li></ul><p>例如：</p><ul><li>很多组件都需要在第一次加载完成后，获取所有学生数据</li><li>很多组件都需要在第一次加载完成后，启动一个计时器，然后在组件销毁时卸载</li></ul><p><strong>使用 Hook 的时候，如果没有严格按照 Hook 的规则进行，eslint 的一个插件（eslint-plugin-react-hooks）会报出警告</strong></p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getAllStudents <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/api&#39;</span>
<span class="token comment">/**
 * 当组件加载完成后，按页获取所有学生数据
 * @param page 页数
 * @param limit 每页数据长度
 * @constructor
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">UseStudentHook</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> limit <span class="token operator">=</span> <span class="token number">10</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span> students<span class="token punctuation">,</span> setStudents <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">getAllStudents</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> limit<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token function">setStudents</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>page<span class="token punctuation">,</span> limit<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> students<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> UseStudentHook<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="reducer-hook" tabindex="-1"><a class="header-anchor" href="#reducer-hook" aria-hidden="true">#</a> Reducer Hook</h3><h4 id="flux-facebook-出品的一个数据流框架" tabindex="-1"><a class="header-anchor" href="#flux-facebook-出品的一个数据流框架" aria-hidden="true">#</a> Flux：Facebook 出品的一个数据流框架</h4><ul><li>规定了数据是单向流动的</li><li>数据存储在数据仓库中（目前，可以认为 state 就是一个存储数据的仓库）</li><li>action 是改变数据的唯一原因（本质上就是一个对象，action 有两个属性） <ul><li>type：字符串，动作的类型，描述干什么</li><li>payload：任意类型，动作发生后的附加信息 <ul><li>例如，如果是添加一个学生，action 可以描述为： <ul><li>{ type:&quot;addStudent&quot;, payload: {学生对象的各种信息} }</li></ul></li><li>例如，如果要删除一个学生，action 可以描述为： <ul><li>{ type:&quot;deleteStudent&quot;, payload: 学生id }</li></ul></li></ul></li></ul></li><li>具体改变数据的是一个函数，该函数叫做 reducer <ul><li>该函数接收两个参数 <ul><li>state：表示当前数据仓库中的数据</li><li>action：描述了如何去改变数据，以及改变数据的一些附加信息</li></ul></li><li>该函数必须有一个返回结果，用于表示数据仓库变化之后的数据 <ul><li>Flux 要求，对象是不可变的，如果返回对象，必须创建新的对象</li></ul></li><li>reducer 必须是纯函数，不能有任何副作用</li><li>如果要触发 reducer，不可以直接调用，而是应该调用一个辅助函数 dispatch <ul><li>该函数仅接收一个参数：action</li><li>该函数会间接去调用 reducer，以达到改变数据的目的</li></ul></li></ul></li><li>React提供了 useReducer，直接引用即可<code>import { useReducer } from &#39;react&#39;;</code></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 通用的useReducer函数
 * @param {function} reducer reducer函数，标准格式
 * @param {any} initialState 初始状态
 * @param {function} initFunc 用于计算初始值的函数
 * @returns {[state,dispatch]}
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">useReducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">,</span> initFunc</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initFunc <span class="token operator">?</span> <span class="token function">initFunc</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span> <span class="token operator">:</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">dispatch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> newState <span class="token operator">=</span> <span class="token function">reducer</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>newState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> useReducer<span class="token punctuation">;</span>
<span class="token comment">// ====================</span>
<span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&#39;increase&#39;</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&#39;decrease&#39;</span><span class="token operator">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> state <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispath<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;increase&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="context-hook" tabindex="-1"><a class="header-anchor" href="#context-hook" aria-hidden="true">#</a> Context Hook</h3><p>用于获取上下文数据</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ctx <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 以前的获取上下文的方法</span>
<span class="token comment">// const Test = () =&gt; {</span>
<span class="token comment">//     return &lt;ctx.Consumer&gt;</span>
<span class="token comment">//         { value =&gt; &lt;h1&gt;Test，上下文的值：{value}&lt;/h1&gt; }</span>
<span class="token comment">//     &lt;/ctx.Consumer&gt;</span>
<span class="token comment">// }</span>
<span class="token comment">// 使用 useContext 获取上下文</span>
<span class="token keyword">const</span> <span class="token function-variable function">Test</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Test，上下文的值：</span><span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">UseContextTest</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctx.Provider</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>abc<span class="token punctuation">&#39;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Test</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctx.Provider</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> UseContextTest<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="callback-hook" tabindex="-1"><a class="header-anchor" href="#callback-hook" aria-hidden="true">#</a> Callback Hook</h3><p>函数名：useCallback</p><ul><li>用于得到一个固定引用值的函数，通常用它进行性能优化</li><li>该函数有两个参数： <ol><li>函数，useCallback会固定该函数的引用，只要依赖项没有发生变化，则始终返回之前函数的地址</li><li>数组，记录依赖项</li></ol></li><li>该函数返回：引用相对固定的函数地址</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useCallback <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Test Render&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>onClick<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">改变文本</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Parent Render&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>txt<span class="token punctuation">,</span> setTxt<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> handleClick <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTxt</span><span class="token punctuation">(</span>txt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>txt<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">handleClickN</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setN</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* 函数的地址每次渲染都发生了变化，导致了子组件跟着重新渲染，若子组件是经过优化的组件，则可能导致优化失效 */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Test</span></span> <span class="token attr-name">text</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>txt<span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>n<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClickN<span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Parent</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="memo-hook" tabindex="-1"><a class="header-anchor" href="#memo-hook" aria-hidden="true">#</a> Memo Hook</h3><p>用于保持一些比较稳定的数据，通常用于性能优化 <strong>如果React元素本身的引用没有发生变化，一定不会重新渲染</strong></p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useMemo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">function</span> <span class="token function">Item</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>range<span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">min</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">10000</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 保持 list 稳定</span>
    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> range<span class="token punctuation">.</span>min<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> range<span class="token punctuation">.</span>max<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Item</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Item</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>range<span class="token punctuation">.</span>min<span class="token punctuation">,</span> range<span class="token punctuation">.</span>max<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// const list = [];</span>
  <span class="token comment">// for (let i = range.min; i &lt;= range.max; i++) {</span>
  <span class="token comment">//     list.push(&lt;Item key={i} value={i}&gt;&lt;/Item&gt;)</span>
  <span class="token comment">// }</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>list<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>n<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">setN</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ref-hook" tabindex="-1"><a class="header-anchor" href="#ref-hook" aria-hidden="true">#</a> Ref Hook</h3><p>useRef函数：</p><ul><li>一个参数：默认值</li><li>返回一个固定的对象，{current: 值}</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">const</span> <span class="token function-variable function">RefHookTest</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> inpRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>inpRef<span class="token punctuation">}</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>inpRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">得到input的值</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>n<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">setN</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> RefHookTest<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>该函数不止可以用于获得 dom，其生成的稳定对象可用于做其他事情</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useRef<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">const</span> <span class="token function-variable function">RefHookTest</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> timerRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 生成一个唯一且稳定的计时器容器</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    timerRef<span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
      <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timerRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> RefHookTest<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>另一种方法：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useRef<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">const</span> <span class="token function-variable function">RefHookTest</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> nRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {current:10}</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      nRef<span class="token punctuation">.</span>current<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token function">setN</span><span class="token punctuation">(</span>nRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>nRef<span class="token punctuation">.</span>current <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> RefHookTest<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="imperativehandle-hook" tabindex="-1"><a class="header-anchor" href="#imperativehandle-hook" aria-hidden="true">#</a> ImperativeHandle Hook</h3><ul><li>函数：useImperativeHandleHook</li><li>三个参数 <ul><li>第一个是传值的 ref</li><li>第二个是一个函数，返回值为传递的内容</li><li>第三个是依赖项，可以不传 <ul><li>如果有值，则第一次调用后，会进行缓存，只有依赖项发生变化时才会重新调用函数</li></ul></li></ul></li><li>函数通过 ref 传递方法或其他值</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useRef<span class="token punctuation">,</span> useImperativeHandle <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useImperativeHandle</span><span class="token punctuation">(</span>ref<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果不给依赖项，则每次运行函数组件都会调用该方法</span>
    <span class="token comment">// 如果使用了依赖项，则第一次调用后，会进行缓存，只有依赖项发生变化时才会重新调用函数</span>
    <span class="token comment">// 相当于给 ref.current = 1</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Test Component Called&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Test Component</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> TestWrapper <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span>Test<span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">UseImperativeHandleHookTest</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> testRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TestWrapper</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>testRef<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          testRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">// console.log(testRef)</span>
          <span class="token comment">// forceUpdate({})</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">点击调用Test组件的method方法</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> UseImperativeHandleHookTest<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="layouteffect-hook" tabindex="-1"><a class="header-anchor" href="#layouteffect-hook" aria-hidden="true">#</a> LayoutEffect Hook</h3><ul><li>useEffect：浏览器渲染完成后，用户看到新的渲染结果之后运行</li><li>useLayoutEffectHook：完成了DOM改动，但还没有呈现给用户的时候运行</li><li>应该尽量使用 useEffect，因为它不会导致渲染阻塞，如果出现了问题，再考虑使用 useLayoutEffectHook</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useLayoutEffect<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">function</span> <span class="token function">UseLayoutEffectHookTest</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>n<span class="token punctuation">,</span> setN<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> h1Ref <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// useEffect(() =&gt; { // 会闪烁一下</span>
  <span class="token comment">//     h1Ref.current.innerText = Math.random().toFixed(2);</span>
  <span class="token comment">// })</span>
  <span class="token function">useLayoutEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 很流畅</span>
    h1Ref<span class="token punctuation">.</span>current<span class="token punctuation">.</span>innerText <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>h1Ref<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">setN</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">+</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> UseLayoutEffectHookTest<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="debugvalue-hook" tabindex="-1"><a class="header-anchor" href="#debugvalue-hook" aria-hidden="true">#</a> DebugValue Hook</h3><ul><li>useDebugValue：用于将自定义 Hook 的关联数据显示到调试栏</li><li>如果创建的自定义 Hook 通用性比较高，可以选择使用 useDebugValue 方便调试</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useEffect<span class="token punctuation">,</span> useDebugValue <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">function</span> <span class="token function">useTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>students<span class="token punctuation">,</span> <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">useDebugValue</span><span class="token punctuation">(</span><span class="token string">&quot;学生集合&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> students<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;effect&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">useTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/vuepress_blog/assets/8-c4733cd4.png" alt="image.png"></p><h1 id="react动画" tabindex="-1"><a class="header-anchor" href="#react动画" aria-hidden="true">#</a> React动画</h1><p>React第三方动画库：<a href="https://reactcommunity.org/react-transition-group/" target="_blank" rel="noopener noreferrer">react-transition-group<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，使用的时候读文档</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Transition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-transition-group&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./App.css&quot;</span>
<span class="token keyword">const</span> duration <span class="token operator">=</span> <span class="token number">2000</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>inProp<span class="token punctuation">,</span> setInProp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Transition</span></span> <span class="token attr-name">in</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>inProp<span class="token punctuation">}</span></span> <span class="token attr-name">timeout</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>duration<span class="token punctuation">}</span></span>
        <span class="token attr-name">addEndListener</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> done</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          node<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;transitionend&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;过渡结束了&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">once</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>state<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            I&#39;m a fade Transition!
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Transition</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setInProp</span><span class="token punctuation">(</span><span class="token operator">!</span>inProp<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        Click to Toggle
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// ==========</span>
div<span class="token punctuation">{</span>
    <span class="token literal-property property">transition</span><span class="token operator">:</span> 2000ms<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>exited<span class="token punctuation">,</span> <span class="token punctuation">.</span>exiting<span class="token punctuation">{</span>
    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>entered<span class="token punctuation">,</span><span class="token punctuation">.</span>entering<span class="token punctuation">{</span>
    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="csstransition" tabindex="-1"><a class="header-anchor" href="#csstransition" aria-hidden="true">#</a> CSSTransition</h2><p><strong>当进入时，发生：</strong></p><ol><li>为CSSTransition内部的DOM根元素（后续统一称之为DOM元素）添加样式enter</li><li>在一下帧(enter样式已经完全应用到了元素)，立即为该元素添加样式enter-active</li><li>当timeout结束后，去掉之前的样式，添加样式enter-done</li></ol><p><strong>当退出时，发生：</strong></p><ol><li>为CSSTransition内部的DOM根元素（后续统一称之为DOM元素）添加样式exit</li><li>在一下帧(exit样式已经完全应用到了元素)，立即为该元素添加样式exit-active</li><li>当timeout结束后，去掉之前的样式，添加样式exit-done</li></ol><p><strong>设置classNames属性，可以指定类样式的名称</strong></p><ol><li>字符串：为类样式添加前缀</li><li>对象：为每个类样式指定具体的名称（非前缀）</li></ol><p>关于首次渲染时的类样式，appear、apear-active、apear-done，它和enter的唯一区别在于完成时，会同时加入apear-done和enter-done <strong>还可以与 <strong><a href="https://animate.style/" target="_blank" rel="noopener noreferrer"><strong>Animate.css</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></strong> 联用</strong></p><h2 id="switchtransition" tabindex="-1"><a class="header-anchor" href="#switchtransition" aria-hidden="true">#</a> SwitchTransition</h2><p>用于有秩序的切换内部组件 <strong>默认情况下：out-in</strong></p><ol><li>当key值改变时，会将之前的DOM根元素添加退出样式（exit,exit-active)</li><li>退出完成后，将该DOM元素移除</li><li>重新渲染内部DOM元素</li><li>为新渲染的DOM根元素添加进入样式(enter, enter-active, enter-done)</li></ol><p><strong>in-out:</strong></p><ol><li>重新渲染内部DOM元素，保留之前的元素</li><li>为新渲染的DOM根元素添加进入样式(enter, enter-active, enter-done)</li><li>将之前的DOM根元素添加退出样式（exit,exit-active)</li><li>退出完成后，将该DOM元素移除</li></ol><p><strong>该库寻找dom元素的方式，是使用已经过时的API：findDomNode，该方法可以找到某个组件下的DOM根元素</strong></p><h2 id="transitiongroup" tabindex="-1"><a class="header-anchor" href="#transitiongroup" aria-hidden="true">#</a> TransitionGroup</h2><p>该组件的children，接收多个Transition或CSSTransition组件，该组件用于根据这些子组件的key值，控制他们的进入和退出状态</p><h2 id="应用" tabindex="-1"><a class="header-anchor" href="#应用" aria-hidden="true">#</a> 应用</h2><h3 id="淡入淡出组件" tabindex="-1"><a class="header-anchor" href="#淡入淡出组件" aria-hidden="true">#</a> 淡入淡出组件</h3><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> CSSTransition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-transition-group&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./index.css&quot;</span>
FadeTransition<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">500</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">FadeTransition</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">addTransition</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    node<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transition <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">opacity </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>timeout<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ms</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">removeTransition</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    node<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transition <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CSSTransition</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span></span> <span class="token attr-name">classNames</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fade<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">onEnter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>addTransition<span class="token punctuation">}</span></span>
      <span class="token attr-name">onEntered</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> isAppear</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">removeTransition</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span>onEntered <span class="token operator">&amp;&amp;</span> props<span class="token punctuation">.</span><span class="token function">onEntered</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> isAppear<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token attr-name">onExit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>addTransition<span class="token punctuation">}</span></span>
      <span class="token attr-name">onExited</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">node</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">removeTransition</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span>onExited <span class="token operator">&amp;&amp;</span> props<span class="token punctuation">.</span><span class="token function">onExited</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">/&gt;</span></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// =============</span>
<span class="token punctuation">.</span>fade<span class="token operator">-</span>exit<span class="token operator">-</span>done<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>exit<span class="token operator">-</span>active<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>appear<span class="token punctuation">{</span>
    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token operator">-</span>active<span class="token punctuation">,</span> <span class="token punctuation">.</span>fade<span class="token operator">-</span>appear<span class="token operator">-</span>active<span class="token punctuation">{</span>
    <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> FadeTransition <span class="token keyword">from</span> <span class="token string">&quot;./FadeTransition&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> TransitionGroup <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-transition-group&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> v4 <span class="token keyword">as</span> uuidv4 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;uuid&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">tasks</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;任务1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;任务2&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;任务3&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TransitionGroup</span></span> <span class="token attr-name">component</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ul<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>tasks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">FadeTransition</span></span> <span class="token attr-name">appear</span> <span class="token attr-name">timeout</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">500</span><span class="token punctuation">}</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>t<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text">
              </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">tasks</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>tasks<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">it</span> <span class="token operator">=&gt;</span> it<span class="token punctuation">.</span>id <span class="token operator">!==</span> t<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
                  <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">删除</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">FadeTransition</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TransitionGroup</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      &lt;button onClick=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> name <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">&quot;请输入任务名称&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">tasks</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>tasks<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token function">uuidv4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name <span class="token punctuation">}</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">&gt;添加</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="react-router" tabindex="-1"><a class="header-anchor" href="#react-router" aria-hidden="true">#</a> React Router</h1><h2 id="路由" tabindex="-1"><a class="header-anchor" href="#路由" aria-hidden="true">#</a> 路由</h2><ul><li>无论是使用Vue，还是React，开发的单页应用程序，可能只是某个站点（域名）的一部分（某一个功能块）</li><li>一个单页应用里，可能会划分为多个页面（几乎完全不同的页面效果）（组件）</li></ul><p><img src="/vuepress_blog/assets/9-dbef0e4d.png" alt="image.png"></p><ul><li>如果要在单页应用中完成组件的切换，需要实现下面两个功能： <ul><li>根据不同的页面地址，展示不同的组件（核心）</li><li>完成无刷新的地址切换</li></ul></li></ul><p><strong>我们把实现了以上两个功能的插件，称之为路由</strong></p><h2 id="react-router-1" tabindex="-1"><a class="header-anchor" href="#react-router-1" aria-hidden="true">#</a> <a href="https://react-guide.github.io/react-router-cn/" target="_blank" rel="noopener noreferrer">React Router<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h2><ul><li>react-router：路由核心库，包含诸多和路由功能相关的核心代码</li><li>react-router-dom：利用路由核心库，结合实际的页面，实现跟页面路由密切相关的功能 <ul><li>学习的是 v5.0.1 版本，后期学习V6版本</li><li>如果是在页面中实现路由，需要安装react-router-dom库</li></ul></li></ul><h2 id="路由的两种模式" tabindex="-1"><a class="header-anchor" href="#路由的两种模式" aria-hidden="true">#</a> 路由的两种模式</h2><ul><li>路由：根据不同的页面地址，展示不同的组件</li><li>url地址组成</li></ul><p>例：<a href="https://gitee.com/link?target=https%3A%2F%2Fwww.react.com%3A443%2Fnews%2F1-2-1.html%3Fa%3D1%26b%3D2%23abcdefg" target="_blank" rel="noopener noreferrer">https://www.react.com:443/news/1-2-1.html?a=1&amp;b=2#abcdefg<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li>协议名(schema)：https</li><li>主机名(host)：www.react.com <ul><li>ip地址</li><li>预设值：localhost</li><li>域名</li><li>局域网中电脑名称</li></ul></li><li>端口号(port)：443 <ul><li>如果协议是http，端口号是80，则可以省略端口号</li><li>如果协议是https，端口号是443，则可以省略端口号</li></ul></li><li>访问路径(path)：/news/1-2-1.html</li><li>地址参数(search/query)：?a=1&amp;b=2 <ul><li>附带的数据</li><li>格式：属性名=属性值&amp;属性名=属性值....</li></ul></li><li>哈希(hash/锚点) <ul><li>附带的数据</li><li>&#39;#&#39;: sharp 符号，叫 sharp，C#：C sharp</li></ul></li></ul><h3 id="hash-router-哈希路由" tabindex="-1"><a class="header-anchor" href="#hash-router-哈希路由" aria-hidden="true">#</a> Hash Router 哈希路由</h3><ul><li>根据url地址中的哈希值来确定显示的组件 <ul><li>hash的变化，不会导致页面刷新</li><li>这种模式的兼容性最好，很早的浏览器都能支持（九几年的都能支持）</li></ul></li></ul><h3 id="borswer-history-router-浏览器历史记录路由" tabindex="-1"><a class="header-anchor" href="#borswer-history-router-浏览器历史记录路由" aria-hidden="true">#</a> Borswer History Router 浏览器历史记录路由</h3><ul><li>HTML5出现后，新增了History Api，从此以后，浏览器拥有了改变路径而不刷新页面的方式 <ul><li>无刷新的改变当前地址，一般用于锚链接</li><li>History表示浏览器的历史记录，它使用栈的方式存储</li><li>指针指向当前访问的路径，通过指针移动访问不同的路径</li></ul></li></ul><p><img src="/vuepress_blog/assets/10-0d6c1687.png" alt="image.png"></p><ul><li>history.length：获取栈中数据量</li><li>history.pushState：向当前历史记录栈中加入一条新的记录 <ol><li>参数1：附加的数据，自定义的数据，可以是任何类型</li><li>参数2：页面标题，目前大部分浏览器不支持</li><li>参数3：新的地址</li></ol></li><li>history.replaceState：将当前指针指向的历史记录，替换为某个记录 <ol><li>参数1：附加的数据，自定义的数据，可以是任何类型</li><li>参数2：页面标题，目前大部分浏览器不支持</li><li>参数3：新的地址</li></ol></li></ul><p><strong>根据页面的路径决定渲染哪个组件</strong></p><h2 id="路由组件" tabindex="-1"><a class="header-anchor" href="#路由组件" aria-hidden="true">#</a> 路由组件</h2><p>React-Router 为我们提供了两个重要组件</p><h2 id="router组件" tabindex="-1"><a class="header-anchor" href="#router组件" aria-hidden="true">#</a> Router组件</h2><p>它本身不做任何展示，仅提供路由模式配置，另外，该组件会产生一个上下文，上下文中会提供一些实用的对象和方法，供其他相关组件使用</p><ul><li>HashRouter：该组件，使用hash模式匹配</li><li>BrowserRouter：该组件，使用BrowserHistory模式匹配</li><li>一般使用 Router 作为别名</li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Routes <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-router-dom&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>通常情况下，Router组件只有一个，将该组件包裹整个页面</strong></p><h3 id="route组件" tabindex="-1"><a class="header-anchor" href="#route组件" aria-hidden="true">#</a> Route组件</h3><p>根据不同的地址，展示不同的组件 重要属性：</p><ul><li>path：匹配的路径 <ul><li>默认情况下，不区分大小写，可以设置 sensitive 属性为 true，来区分大小写</li><li>默认情况下，只匹配初始目录，如果要精确匹配，配置 exact 属性为 true</li><li>如果不写path，则会匹配任意路径</li><li>可以是数组<code>path = [&#39;/news&#39;, &#39;/news/a&#39;]</code></li></ul></li><li>component：匹配成功后要显示的组件，属性值为花括号包裹的组件 {Home}（react-router-dom v6版本换了名字并更新了功能，叫 element，且属性值要写成 JSX组件的形式，<!---->）</li><li>render：<code>render = { (values) =&gt; { return 一个React元素 } }</code></li><li></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Route<span class="token punctuation">,</span> Redirect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span>
<span class="token keyword">import</span> loginInfo <span class="token keyword">from</span> <span class="token string">&quot;./loginInfo&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">ProtectedRoute</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token literal-property property">component</span><span class="token operator">:</span> Component<span class="token punctuation">,</span> children<span class="token punctuation">,</span> render<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Route <span class="token punctuation">{</span><span class="token operator">...</span>rest<span class="token punctuation">}</span>
                  render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">values</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                      <span class="token keyword">if</span> <span class="token punctuation">(</span>loginInfo<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                          <span class="token comment">//可以正常展示页面</span>
                          <span class="token keyword">return</span> <span class="token operator">&lt;</span>Component <span class="token operator">/</span><span class="token operator">&gt;</span>
                      <span class="token punctuation">}</span>
                      <span class="token keyword">else</span> <span class="token punctuation">{</span>
                          <span class="token comment">// return &lt;Redirect to={{</span>
                          <span class="token comment">//     pathname: &quot;/login&quot;,</span>
                          <span class="token comment">//     search: &quot;?returnurl=&quot; + values.location.pathname</span>
                          <span class="token comment">// }} /&gt;</span>
                          <span class="token comment">//  返回重定向组件 Redirect</span>
                          <span class="token keyword">return</span> <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                              <span class="token literal-property property">pathname</span><span class="token operator">:</span> <span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span>
                              <span class="token literal-property property">state</span><span class="token operator">:</span> values<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname
                          <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                      <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Route组件可以写子元素，children：</p><ul><li>传递React元素，无论是否匹配，一定会显示 children，并且会忽略 component 属性</li><li>传递一个函数，该函数有多个参数，这些参数来自于上下文，该函数返回 react 元素，则一定会显示返回的元素，并且忽略 component 属性</li><li>如果使用了Switch组件，且没有匹配上，就不会显示子元素</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span>Route exact sensitive path<span class="token operator">=</span><span class="token string">&quot;/a&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span><span class="token constant">A</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>必定会看到的内容<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Route组件可以写到任意的地方，只要保证它是Router组件的后代元素</strong><strong>v6版本中Route组件必须包裹在Routes内</strong></p><h3 id="switch组件-react-router-dom-v6版本换了名字并更新了功能-叫routes" tabindex="-1"><a class="header-anchor" href="#switch组件-react-router-dom-v6版本换了名字并更新了功能-叫routes" aria-hidden="true">#</a> Switch组件（react-router-dom v6版本换了名字并更新了功能，叫Routes）</h3><ul><li>写到Switch组件中的Route组件，当匹配到第一个Route后，会立即停止匹配</li><li>由于Switch组件会循环所有子元素，然后让每个子元素去完成匹配，若匹配到，则渲染对应的组件，然后停止循环 <ul><li>因此，不能在Switch的子元素中使用除Route外的其他组件</li></ul></li></ul><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Switch<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-router-dom&#39;</span>
<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">组件A</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">组件B</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token constant">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">组件C</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/abc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">D</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token constant">D</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">组件D</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Router</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/*加了Switch匹配不上路径就不会渲染子元素了*/</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Switch</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span></span> <span class="token attr-name">exact</span> <span class="token attr-name">sensitive</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/a<span class="token punctuation">&quot;</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">A</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">必定会看到的内容</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Route</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span></span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/a/b<span class="token punctuation">&quot;</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">B</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Route</span></span> <span class="token attr-name">component</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">C</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Switch</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Router</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="路由信息" tabindex="-1"><a class="header-anchor" href="#路由信息" aria-hidden="true">#</a> 路由信息</h2><ul><li>Route组件会创建一个上下文，并且，向上下文中注入一些信息，上下文中有三个对象：history、location、match</li><li>该上下文对开发者是隐藏的，Route组件若匹配到了地址，则会将这些上下文中的信息作为属性传入对应的组件</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Switch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span>
<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>组件<span class="token constant">A</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;/b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;状态数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>跳转到<span class="token operator">/</span>b<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>组件<span class="token constant">B</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
            获取状态数据：<span class="token punctuation">{</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span>location<span class="token punctuation">.</span>state<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;/a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>跳转到<span class="token operator">/</span>a<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>找不到页面<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/a&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span><span class="token constant">A</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/b&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span><span class="token constant">B</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Route component<span class="token operator">=</span><span class="token punctuation">{</span>NotFound<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="history" tabindex="-1"><a class="header-anchor" href="#history" aria-hidden="true">#</a> history</h3><p>它并不是window.history对象，通常利用该对象无刷新跳转地址</p><ul><li>**为什么没有直接使用 **window.history <strong>对象？</strong><ul><li>React-Router中有两种模式：Hash、History，如果直接使用window.history，只能支持一种模式</li><li>当使用windows.history.pushState方法时，没有办法收到任何通知，将导致React无法知晓地址发生了变化，结果导致无法重新渲染组件</li></ul></li><li>push：将某个新的地址入栈（历史记录栈） <ul><li>参数1：新的地址 <ul><li>只能写相对路径，本站的地址，不能写绝对路径</li></ul></li><li>参数2：可选，附带的状态数据，不是很常用</li></ul></li><li>replace：将某个新的地址替换掉当前栈中的地址，与push参数一样</li><li>go: 与window.history一致</li><li>forward: 与window.history一致</li><li>back: 与window.history一致</li></ul><h3 id="location" tabindex="-1"><a class="header-anchor" href="#location" aria-hidden="true">#</a> location</h3><ul><li>与history.location完全一致，是同一个对象，但是，与window.location不同</li><li>location对象中记录了当前地址的相关信息</li><li>我们通常使用第三方库<code>query-string</code>，用于解析地址栏中的数据（参数、hash等），解析出来是一个对象 <ul><li><code>import qs from &#39;query-string&#39;</code></li><li><code>qs.parse(props.location.search)</code></li></ul></li><li>pathname：路径地址</li><li>search：地址栏参数</li><li>hash</li><li>state：附带的状态数据</li></ul><h3 id="match" tabindex="-1"><a class="header-anchor" href="#match" aria-hidden="true">#</a> match</h3><p>该对象中保存了，路由规则匹配的相关信息</p><ul><li>isExact：事实上，当前的路径和路由配置的路径是否是精确匹配的</li><li>params：获取路径规则中对应的数据</li><li>path：使用的路径规则</li><li>url：真正的路径</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Switch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span>
<span class="token keyword">import</span> qs <span class="token keyword">from</span> <span class="token string">&quot;query-string&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>location<span class="token punctuation">)</span>
    <span class="token keyword">const</span> query <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> hash <span class="token operator">=</span> qs<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>组件<span class="token constant">A</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
            访问地址：<span class="token punctuation">{</span>props<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
            <span class="token literal-property property">地址参数：a</span><span class="token operator">:</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>b<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">c</span><span class="token operator">:</span><span class="token punctuation">{</span>query<span class="token punctuation">.</span>c<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>
            <span class="token literal-property property">hash</span><span class="token operator">:</span> d<span class="token operator">:</span><span class="token punctuation">{</span>hash<span class="token punctuation">.</span>d<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">f</span><span class="token operator">:</span><span class="token punctuation">{</span>hash<span class="token punctuation">.</span>f<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>找不到页面<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/a&quot;</span> exact component<span class="token operator">=</span><span class="token punctuation">{</span><span class="token constant">A</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Route component<span class="token operator">=</span><span class="token punctuation">{</span>NotFound<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// http://localhost:3000/a?a=12&amp;b=32&amp;c=90#d=12&amp;f=123</span>
<span class="token comment">// 访问地址：/a</span>
<span class="token comment">// 地址参数：a:12, b:32, c:90</span>
<span class="token comment">// hash: d:12, f:123</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>实际上，在书写Route组件的path属性时，可以书写一个<code>string pattern</code>（字符串正则，类似正则但不是正则） <strong>react-router使用了第三方库处理params的数据：Path-to-RegExp，该库的作用是，将一个字符串正则转换成一个真正的正则表达式</strong></p><ul><li>向某个页面传递数据的方式 <ul><li>使用state：在push页面时，加入state，不常见</li><li><strong>利用search：把数据填写到地址栏中的 ? 后，常见</strong></li><li>利用hash：把数据填写到hash后，不常见</li><li><strong>params：把数据填写到路径中，最常见</strong><ul><li><strong>用法配合 <strong><a href="https://www.npmjs.com/package/path-to-regexp" target="_blank" rel="noopener noreferrer"><strong>Path-to-RegExp</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></strong> 文档</strong></li></ul></li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Switch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span>
<span class="token keyword">function</span> <span class="token function">News</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>显示<span class="token punctuation">{</span>props<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">.</span>year<span class="token punctuation">}</span>年<span class="token punctuation">{</span>props<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">.</span>month<span class="token punctuation">}</span>月<span class="token punctuation">{</span>props<span class="token punctuation">.</span>match<span class="token punctuation">.</span>params<span class="token punctuation">.</span>day<span class="token punctuation">}</span>日的新闻<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>找不到页面<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/news/:year(\d+)/:month(\d+)/:day(\d+)/*&quot;</span> exact component<span class="token operator">=</span><span class="token punctuation">{</span>News<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Route component<span class="token operator">=</span><span class="token punctuation">{</span>NotFound<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
     <span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// http://localhost:3000/news/2012/2/12/a</span>
<span class="token comment">// props: {</span>
<span class="token comment">//     history: {</span>
<span class="token comment">//         length: 5,</span>
<span class="token comment">//         action: &quot;POP&quot;,</span>
<span class="token comment">//         location: {</span>
<span class="token comment">//             pathname: &quot;/news/2012/2/12/a&quot;,</span>
<span class="token comment">//             search: &quot;&quot;,</span>
<span class="token comment">//             hash: &quot;&quot;</span>
<span class="token comment">//         }</span>
<span class="token comment">//     },</span>
<span class="token comment">//     location: {</span>
<span class="token comment">//         pathname: &quot;/news/2012/2/12/a&quot;,</span>
<span class="token comment">//         search: &quot;&quot;,</span>
<span class="token comment">//         hash: &quot;&quot;,</span>
<span class="token comment">//         state: undefined</span>
<span class="token comment">//     },</span>
<span class="token comment">//     match: {</span>
<span class="token comment">//         path: &quot;/news/:year(\\d+)/:month(\\d+)/:day(\\d+)/*&quot;,</span>
<span class="token comment">//         url: &quot;/news/2012/2/12/a&quot;,</span>
<span class="token comment">//         isExact: true,</span>
<span class="token comment">//         params: {</span>
<span class="token comment">//             0: &quot;a&quot;,</span>
<span class="token comment">//             year: &quot;2012&quot;,</span>
<span class="token comment">//             month: &quot;2&quot;,</span>
<span class="token comment">//             day: &quot;12&quot;</span>
<span class="token comment">//         }</span>
<span class="token comment">//     },</span>
<span class="token comment">//		 staticContext: undefined</span>
<span class="token comment">// }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="非路由组件获取路由信息" tabindex="-1"><a class="header-anchor" href="#非路由组件获取路由信息" aria-hidden="true">#</a> 非路由组件获取路由信息</h3><p>某些组件，并没有直接放到Route中，而是嵌套在其他普通组件中，因此，它的props中没有路由信息，如果这些组件需要获取到路由信息，可以使用下面两种方式：</p><ol><li>将路由信息从父组件一层一层传递到子组件</li><li>使用react-router提供的高阶组件withRouter，包装要使用的组件，该高阶组件会返回一个新组件，新组件会注入路由信息</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Switch<span class="token punctuation">,</span> withRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span>
<span class="token keyword">const</span> AWrapper <span class="token operator">=</span> <span class="token function">withRouter</span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// function withRouter(Comp) {</span>
<span class="token comment">//     return function routerWrapper(props) {</span>
<span class="token comment">//         //获取上下文中的信息</span>
<span class="token comment">//         return &lt;Comp {...props} history={上下文中的history} /&gt;</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
<span class="token keyword">function</span> <span class="token function">News</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>新闻列表<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
      	<span class="token operator">&lt;</span>AWrapper <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点击返回<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>首页<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">NotFound</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>找不到页面<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Switch<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/news&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>News<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/&quot;</span> exact component<span class="token operator">=</span><span class="token punctuation">{</span>Index<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>Route component<span class="token operator">=</span><span class="token punctuation">{</span>NotFound<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="其他组件" tabindex="-1"><a class="header-anchor" href="#其他组件" aria-hidden="true">#</a> 其他组件</h2><h3 id="link" tabindex="-1"><a class="header-anchor" href="#link" aria-hidden="true">#</a> Link</h3><p>生成一个无刷新跳转的a元素</p><ul><li>to <ul><li>字符串：跳转的目标地址</li><li>对象： <ul><li>pathname：url路径</li><li>search</li><li>hash</li><li>state：附加的状态信息</li></ul></li></ul></li><li>replace：bool，表示是否是替换当前地址，默认是false</li><li>innerRef：可以将内部的a元素的ref附着在传递的对象或函数参数上 <ul><li>函数</li><li>ref对象</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> withRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 手写 Link 组件，其实就是使用了 router 中 history</span>
<span class="token keyword">function</span> <span class="token function">TestLink</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&#39;javascript:&#39;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>to<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withRouter</span><span class="token punctuation">(</span>TestLink<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// import TestLink from &#39;./testLink&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> Link<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-router-dom&#39;</span>
<span class="token keyword">function</span> <span class="token function">PageA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token constant">A</span>页<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">PageB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token constant">B</span>页<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">NavBar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token comment">/*&lt;TestLink to=&#39;/a&#39; &gt;去A页&lt;/TestLink&gt;*/</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span><span class="token comment">/*&lt;TestLink to=&#39;/b&#39; &gt;去B页&lt;/TestLink&gt;*/</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&#39;/a&#39;</span> <span class="token operator">&gt;</span>去<span class="token constant">A</span>页<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
            <span class="token literal-property property">pathname</span><span class="token operator">:</span> <span class="token string">&#39;/b&#39;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">hash</span><span class="token operator">:</span> <span class="token string">&quot;#abc&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">search</span><span class="token operator">:</span> <span class="token string">&quot;?a=1&amp;b=2&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&gt;</span>去<span class="token constant">B</span>页<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Router<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>NavBar <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&#39;/a&#39;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>PageA<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&#39;/b&#39;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>PageB<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="navlink" tabindex="-1"><a class="header-anchor" href="#navlink" aria-hidden="true">#</a> NavLink</h3><p>是一种特殊的Link，Link组件具备的功能，它都有 它具备的额外功能是：根据当前地址和链接地址，来决定该链接的样式</p><ul><li>activeClassName: 匹配时使用的类名</li><li>activeStyle: 匹配时使用的内联样式</li><li>exact: 是否精确匹配</li><li>sensitive：匹配时是否区分大小写</li><li>strict：是否严格匹配最后一个斜杠</li></ul><h3 id="redirect-react-router-dom-v6版本换了名字并更新了功能-叫usenavigate" tabindex="-1"><a class="header-anchor" href="#redirect-react-router-dom-v6版本换了名字并更新了功能-叫usenavigate" aria-hidden="true">#</a> Redirect（react-router-dom v6版本换了名字并更新了功能，叫useNavigate）</h3><p>重定向组件，当加载到该组件时，会自动跳转（无刷新）到另外一个地址</p><ul><li>to：跳转的地址 <ul><li>字符串</li><li>对象</li></ul></li><li>push: 默认为false，表示跳转使用替换的方式，设置为true后，则使用push的方式跳转</li><li>from：当匹配到from地址规则时才进行跳转</li><li>exact: 是否精确匹配from</li><li>sensitive：from匹配时是否区分大小写</li><li>strict：from是否严格匹配最后一个斜杠</li></ul><h2 id="导航守卫" tabindex="-1"><a class="header-anchor" href="#导航守卫" aria-hidden="true">#</a> 导航守卫</h2><p>导航守卫：当离开一个页面，进入另一个页面时，触发的事件</p><h3 id="history对象" tabindex="-1"><a class="header-anchor" href="#history对象" aria-hidden="true">#</a> history对象</h3><ul><li>listen: 添加一个监听器，监听地址的变化，当地址发生变化时，会调用传递的函数 <ul><li>参数：函数，运行时间点：发生在即将跳转到新页面时 <ul><li>参数1：location对象，记录当前的地址信息</li><li>参数2：action，一个字符串，表示进入该地址的方式 <ul><li>POP：出栈 <ul><li>通过点击浏览器后退、前进</li><li>调用history.go</li><li>调用history.goBack</li><li>调用history.goForward</li></ul></li><li>PUSH：入栈 <ul><li>history.push</li></ul></li><li>REPLACE：替换 <ul><li>history.replace</li></ul></li></ul></li></ul></li><li>返回结果：函数，可以调用该函数取消监听</li></ul></li><li>block：设置一个阻塞，并同时设置阻塞消息，当页面发生跳转时，会进入阻塞，并将阻塞消息传递到路由根组件的getUserConfirmation方法。 <ul><li>参数：一个必须有返回值的函数，函数有两个参数，分别是要跳转路由信息和跳转方式，函数内必须有返回值</li><li>调用block返回一个回调函数，用于取消阻塞器</li></ul></li></ul><h3 id="路由根组件堵塞跳转属性" tabindex="-1"><a class="header-anchor" href="#路由根组件堵塞跳转属性" aria-hidden="true">#</a> 路由根组件堵塞跳转属性</h3><ul><li>getUserConfirmation <ul><li>参数：函数 <ul><li>参数1：阻塞消息 <ul><li>字符串消息</li><li>函数，函数的返回结果是一个字符串，用于表示阻塞消息 <ul><li>参数1：location对象</li><li>参数2：action值</li></ul></li></ul></li><li>参数2：回调函数，调用该函数并传递true，则表示进入到新页面，否则，不做任何操作</li></ul></li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 内部实现</span>
getUserConfirmation <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">callback</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span>ms<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="常见应用" tabindex="-1"><a class="header-anchor" href="#常见应用" aria-hidden="true">#</a> 常见应用</h2><ul><li>嵌套路由路径 <ul><li>使用 match 动态的获取父组件依赖的路径</li><li>单独设置配置对象，放置路由规则和路径</li></ul></li><li>滚动条复位 <ul><li>高阶组件</li><li>使用useEffect</li><li>使用自定义的导航守卫</li></ul></li><li>阻止跳转，页面鉴权保护 <ul><li>比如判断是否登录，为登录先跳转到登录页面，登录后再跳转回来</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Route<span class="token punctuation">,</span> Redirect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span>
<span class="token keyword">import</span> loginInfo <span class="token keyword">from</span> <span class="token string">&quot;./loginInfo&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">ProtectedRoute</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token literal-property property">component</span><span class="token operator">:</span> Component<span class="token punctuation">,</span> children<span class="token punctuation">,</span> render<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Route <span class="token punctuation">{</span><span class="token operator">...</span>rest<span class="token punctuation">}</span>
                  render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">values</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// values 为路由信息</span>
                      <span class="token keyword">if</span> <span class="token punctuation">(</span>loginInfo<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                          <span class="token comment">//可以正常展示页面</span>
                          <span class="token keyword">return</span> <span class="token operator">&lt;</span>Component <span class="token operator">/</span><span class="token operator">&gt;</span>
                      <span class="token punctuation">}</span>
                      <span class="token keyword">else</span> <span class="token punctuation">{</span>
                          <span class="token comment">// return &lt;Redirect to={{</span>
                          <span class="token comment">//     pathname: &quot;/login&quot;,</span>
                          <span class="token comment">//     search: &quot;?returnurl=&quot; + values.location.pathname</span>
                          <span class="token comment">// }} /&gt;</span>
                          <span class="token comment">//  返回重定向组件 Redirect</span>
                          <span class="token keyword">return</span> <span class="token operator">&lt;</span>Redirect to<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                              <span class="token literal-property property">pathname</span><span class="token operator">:</span> <span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span>
                              <span class="token literal-property property">state</span><span class="token operator">:</span> values<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname
                          <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                      <span class="token punctuation">}</span>
                  <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">,</span> Route<span class="token punctuation">,</span> NavLink <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./index.css&quot;</span>
<span class="token keyword">import</span> Page1 <span class="token keyword">from</span> <span class="token string">&quot;./Page1&quot;</span>
<span class="token keyword">import</span> Page2 <span class="token keyword">from</span> <span class="token string">&quot;./Page2&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">RouterStop</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Router getUserConfirmation<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">callback</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 手写默认getUserConfirmation</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;nav&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>NavLink to<span class="token operator">=</span><span class="token string">&quot;/page1&quot;</span><span class="token operator">&gt;</span>页面<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>NavLink<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>NavLink to<span class="token operator">=</span><span class="token string">&quot;/page2&quot;</span><span class="token operator">&gt;</span>页面<span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>NavLink<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;container&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/page1&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Page1<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">&quot;/page2&quot;</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Page2<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Router<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> RouterStop<span class="token punctuation">;</span>


<span class="token comment">// page1</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>
            Page1
        <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token comment">// page2</span>
<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token comment">// import { Prompt } from &quot;react-router-dom&quot;</span>
<span class="token keyword">import</span> Prompt <span class="token keyword">from</span> <span class="token string">&quot;./Prompt&quot;</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Page2</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">val</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Prompt when<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val <span class="token operator">!==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">}</span>
                        message<span class="token operator">=</span><span class="token string">&quot;别乱来，会导致数据丢失，真的要跳转吗？&quot;</span>
                <span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>textarea value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>val<span class="token punctuation">}</span>
                          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                              <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                  <span class="token literal-property property">val</span><span class="token operator">:</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
                              <span class="token punctuation">}</span><span class="token punctuation">)</span>
                          <span class="token punctuation">}</span><span class="token punctuation">}</span>
                <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>textarea<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// 手写Prompt</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> withRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-router-dom&quot;</span>

<span class="token keyword">class</span> <span class="token class-name">Prompt</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>

    <span class="token keyword">static</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">when</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//当when为true的时候，添加阻塞</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token comment">//当阻塞时，跳转页面的提示消息</span>
    <span class="token punctuation">}</span>

    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token function">handleBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>when<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//添加阻塞</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>unBlock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">block</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unBlock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>unBlock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">unBlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withRouter</span><span class="token punctuation">(</span>Prompt<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="路由切换动画" tabindex="-1"><a class="header-anchor" href="#路由切换动画" aria-hidden="true">#</a> 路由切换动画</h3><p>第三方动画库：react-transition-group CSSTransition：用于为内部的DOM元素添加类样式，通过in属性决定内部的DOM处于退出还是进入阶段。</p><h1 id="router源码学习" tabindex="-1"><a class="header-anchor" href="#router源码学习" aria-hidden="true">#</a> Router源码学习</h1><h2 id="path-to-regexp" tabindex="-1"><a class="header-anchor" href="#path-to-regexp" aria-hidden="true">#</a> path-to-regexp</h2><p>**创建一个match对象，**第三方库：path-to-regexp，用于将一个字符串正则（路径正则，path regexp）</p><h2 id="history对象-1" tabindex="-1"><a class="header-anchor" href="#history对象-1" aria-hidden="true">#</a> history对象</h2><p>该对象提供了一些方法，用于控制或监听地址的变化。 该对象<strong>不是</strong>window.history，而是一个抽离的对象，它提供统一的API接口，封装了具体的实现</p><ul><li>createBrowserHistory 产生的控制浏览器真实地址的history对象</li><li>createHashHistory 产生的控制浏览器hash的history对象</li><li>createMemoryHistory 产生的控制内存中地址数组的history对象</li></ul><p>history对象共同的特点：维护了一个地址栈 第三方库：history <strong>以下三个函数，虽然名称和参数不同，但返回的对象结构(history)完全一致</strong></p><h3 id="history对象-2" tabindex="-1"><a class="header-anchor" href="#history对象-2" aria-hidden="true">#</a> history对象</h3><ul><li>action：当前地址栈，最后一次操作的类型 <ul><li>如果是通过createXXXHistory函数新创建的history对象，action固定为POP</li><li>如果调用了history的push方法，action变为PUSH</li><li>如果调用了history的replace方法，action变为REPLACE</li></ul></li><li>push：向当前地址栈指针位置，入栈一个地址</li><li>replace：替换指针指向的地址</li><li>go：控制当前地址栈指针偏移，如果是0，地址不变；如果是负数，则后退指定的步数；如果是正数，则前进指定的步数；</li><li>length：当前栈中的地址数量</li><li>goBack：相当于go(-1)</li><li>goForward：相当于go(1)</li><li>location：表达当前地址中的信息</li><li>listen：函数，用于监听地址栈指针的变化 <ul><li>该函数接收一个函数作为参数，该参数表示地址变化后要做的事情 <ul><li>参数函数接收两个参数</li><li>location：记录了新的地址</li><li>action：进入新地址的方式 <ul><li>POP：指针移动，调用go、goBack、goForward、用户点击浏览器后退按钮</li><li>PUSH：调用history.push</li><li>REPLACE：调用history.replace</li></ul></li></ul></li><li>该函数有一个返回值，返回的是一个函数，用于取消监听</li></ul></li><li>block：用于设置一个阻塞，当页面发生跳转时，会将指定的消息传递到getUserConfirmation，并调用getUserConfirmation函数 <ul><li>该函数接收一个字符串作为参数，表示消息内容，也可以接收一个函数作为参数，函数的返回值是消息内容</li><li>该函数返回一个取消函数，调用取消函数可以解除阻塞</li></ul></li><li>createHref：basename+url</li></ul><h3 id="createbrowserhistory" tabindex="-1"><a class="header-anchor" href="#createbrowserhistory" aria-hidden="true">#</a> createBrowserHistory</h3><p>创建一个使用浏览器History Api的history对象 配置对象：</p><ul><li>basename：设置根路径</li><li>forceRefresh：地址改变时是否强制刷新页面</li><li>keyLength：location对象使用的key值长度 <ul><li>地址栈中记录的并非字符串，而是一个location对象</li></ul></li><li>getUserConfirmation：一个函数，该函数当调用history对象block函数后，发生页面跳转时运行</li></ul><h3 id="createhashhistory" tabindex="-1"><a class="header-anchor" href="#createhashhistory" aria-hidden="true">#</a> createHashHistory</h3><p>创建一个使用浏览器hash的history对象 配置对象：</p><ul><li>hashType：#号后给定的路径格式 <ul><li>hashbang：被chrome弃用，#!路径</li><li>noslash：#a/b/c</li><li>slash：#/a/b/c</li></ul></li></ul><h3 id="creatememoryhistory" tabindex="-1"><a class="header-anchor" href="#creatememoryhistory" aria-hidden="true">#</a> createMemoryHistory</h3><p>创建一个使用内存中的地址栈的history对象，一般用于没有地址栏的环境 配置对象：详见memoryHistory.js</p><h2 id="手写createbrowserhistory" tabindex="-1"><a class="header-anchor" href="#手写createbrowserhistory" aria-hidden="true">#</a> 手写createBrowserHistory</h2><h3 id="创建location" tabindex="-1"><a class="header-anchor" href="#创建location" aria-hidden="true">#</a> 创建location</h3><p>state处理： <code>**const** historyState = window.history.state;</code></p><ul><li>如果historyState没有值，则state为undefined</li><li>如果historyState有值 <ul><li>如果值的类型不是对象</li><li>是对象 <ul><li>该对象中有key属性，将key属性作为location的key属性值，并且将historyState对象中的state属性作为state属性值</li><li>如果没有key属性，则直接将historyState赋值给state</li></ul></li></ul></li></ul><h2 id="手写router" tabindex="-1"><a class="header-anchor" href="#手写router" aria-hidden="true">#</a> 手写Router</h2><h2 id="手写route" tabindex="-1"><a class="header-anchor" href="#手写route" aria-hidden="true">#</a> 手写Route</h2><h2 id="手写switch" tabindex="-1"><a class="header-anchor" href="#手写switch" aria-hidden="true">#</a> 手写Switch</h2><ul><li>Switch：匹配Route子元素，渲染第一个匹配到的Route</li><li>实现Switch：循环Switch组件的children，依次匹配每一个Route组件，当匹配到时，直接渲染，停止循环</li></ul><h2 id="手写withrouter" tabindex="-1"><a class="header-anchor" href="#手写withrouter" aria-hidden="true">#</a> 手写withRouter</h2><p>HOC高阶组件，用于将路由上下文中的数据，作为属性注入到组件中</p><h2 id="手写link" tabindex="-1"><a class="header-anchor" href="#手写link" aria-hidden="true">#</a> 手写Link</h2><h1 id="redux" tabindex="-1"><a class="header-anchor" href="#redux" aria-hidden="true">#</a> <a href="http://cn.redux.js.org/" target="_blank" rel="noopener noreferrer">Redux<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h1><p>action reducer store</p><h2 id="mvc" tabindex="-1"><a class="header-anchor" href="#mvc" aria-hidden="true">#</a> MVC</h2><p>它是一个UI的解决方案，用于降低UI，以及UI关联的数据的复杂度。 <strong>传统的服务器端的MVC</strong><img src="/vuepress_blog/assets/11-9453114d.png" alt="image.png"> 环境：</p><ul><li>服务端需要响应一个完整的HTML</li><li>该HTML中包含页面需要的数据</li><li>浏览器仅承担渲染页面的作用</li></ul><p>以上的这种方式叫做<strong>服务端渲染</strong>，即服务器端将完整的页面组装好之后，一起发送给客户端。 服务器端需要处理UI中要用到的数据，并且要将数据嵌入到页面中，最终生成一个完整的HTML页面响应。 为了降低处理这个过程的复杂度，出现了MVC模式。 <img src="/vuepress_blog/assets/12-bb196fc0.png" alt="image.png"></p><ul><li><strong>Controller</strong>: 处理请求，组装这次请求需要的数据</li><li><strong>Model</strong>：需要用于UI渲染的数据模型</li><li><strong>View</strong>：视图，用于将模型组装到界面中</li></ul><p><strong>前端MVC模式的困难</strong> React解决了 数据 -&gt; 视图 的问题</p><ol><li>前端的controller要比服务器复杂很多，因为前端中的controller处理的是用户的操作，而用户的操作场景是复杂的。</li><li>对于那些组件化的框架（比如vue、react），它们使用的是单向数据流。若需要共享数据，则必须将数据提升到顶层组件，然后数据再一层一层传递，极其繁琐。 虽然可以使用上下文来提供共享数据，但对数据的操作难以监控，容易导致调试错误的困难，以及数据还原的困难。并且，若开发一个大中型项目，共享的数据很多，会导致上下文中的数据变得非常复杂。</li></ol><p>比如，上下文中有如下格式的数据：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code>value <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">users</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function-variable function">addUser</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">u</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">deleteUser</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">u</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">updateUser</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">u</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="前端需要一个独立的数据解决方案" tabindex="-1"><a class="header-anchor" href="#前端需要一个独立的数据解决方案" aria-hidden="true">#</a> 前端需要一个独立的数据解决方案</h2><h3 id="flux" tabindex="-1"><a class="header-anchor" href="#flux" aria-hidden="true">#</a> Flux</h3><p>Facebook提出的数据解决方案，它的最大历史意义，在于它引入了action的概念</p><ul><li>action是一个普通的对象，用于描述要干什么。<strong>action是触发数据变化的唯一原因</strong></li><li>store表示数据仓库，用于存储共享数据。还可以根据不同的action更改仓库中的数据</li></ul><p>示例：</p><div class="language-jsx line-numbers-mode" data-ext="jsx"><pre class="language-jsx"><code><span class="token keyword">const</span> loginAction <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;login&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">loginId</span><span class="token operator">:</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">loginPwd</span><span class="token operator">:</span><span class="token string">&quot;123123&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> deleteAction <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;delete&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">payload</span><span class="token operator">:</span> <span class="token number">1</span>  <span class="token comment">// 用户id为1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="redux-1" tabindex="-1"><a class="header-anchor" href="#redux-1" aria-hidden="true">#</a> Redux</h3><p>在Flux基础上，引入了reducer的概念 reducer：处理器，用于根据action来处理数据，处理后的数据会被仓库重新保存 <img src="/vuepress_blog/assets/13-d34a910c.png" alt="image.png"></p><h2 id="action" tabindex="-1"><a class="header-anchor" href="#action" aria-hidden="true">#</a> Action</h2><ul><li>action是一个plain-object（平面对象） <ul><li>它的__proto__指向Object.prototype</li></ul></li><li>通常，使用payload属性表示附加数据（没有强制要求）</li><li>action中必须有type属性，该属性用于描述操作的类型 <ul><li>但是，没有对type的类型做出要求</li></ul></li><li>在大型项目，由于操作类型非常多，为了避免硬编码（hard code），会将action的类型存放到一个或一些单独的文件中(样板代码)。</li><li>为了方面传递action，通常会使用action创建函数(action creator)来创建action <ul><li>action创建函数应为无副作用的纯函数 <ul><li>不能以任何形式改动参数</li><li>不可以有异步</li><li>不可以对外部环境中的数据造成影响</li></ul></li></ul></li><li>为了方便利用action创建函数来分发（触发）action，redux提供了一个函数bindActionCreators，该函数用于增强action创建函数的功能，使它不仅可以创建action，并且创建后会自动完成分发。</li></ul><h2 id="reducer" tabindex="-1"><a class="header-anchor" href="#reducer" aria-hidden="true">#</a> Reducer</h2><p>Reducer是用于改变数据的函数</p><ul><li>一个数据仓库，有且仅有一个reducer，并且通常情况下，一个工程只有一个仓库，因此，一个系统，只有一个reducer</li><li>为了方便管理，通常会将reducer放到单独的文件中。</li><li>reducer被调用的时机 <ul><li>通过store.dispatch，分发了一个action，此时，会调用reducer</li><li>当创建一个store的时候，会调用一次reducer <ul><li>可以利用这一点，用reducer初始化状态</li><li>创建仓库时，不传递任何默认状态</li><li>将reducer的参数state设置一个默认值</li></ul></li></ul></li><li>reducer内部通常使用switch来判断type值</li><li><strong>reducer必须是一个没有副作用的纯函数</strong><ul><li>为什么需要纯函数 <ul><li>纯函数有利于测试和调式</li><li>有利于还原数据</li><li>有利于将来和react结合时的优化</li></ul></li><li>具体要求 <ul><li>不能改变参数，因此若要让状态变化，必须得到一个新的状态</li><li>不能有异步</li><li>不能对外部环境造成影响</li></ul></li></ul></li><li>由于在大中型项目中，操作比较复杂，数据结构也比较复杂，因此，需要对reducer进行细分。 <ul><li>redux提供了方法，可以帮助我们更加方便的合并reducer</li><li>combineReducers: 合并reducer，得到一个新的reducer，该新的reducer管理一个对象，该对象中的每一个属性交给对应的reducer管理。</li></ul></li></ul><h2 id="store" tabindex="-1"><a class="header-anchor" href="#store" aria-hidden="true">#</a> Store</h2><p>Store：用于保存数据 通过createStore方法创建的对象。 该对象的成员：</p><ul><li>dispatch：分发一个action</li><li>getState：得到仓库中当前的状态</li><li>replaceReducer：替换掉当前的reducer</li><li>subscribe：注册一个监听器，监听器是一个无参函数，该分发一个action之后，会运行注册的监听器。该函数会返回一个函数，用于取消监听</li></ul><h2 id="手写createstore" tabindex="-1"><a class="header-anchor" href="#手写createstore" aria-hidden="true">#</a> 手写createStore</h2><p>返回一个对象：</p><ul><li>dispatch：分发一个action</li><li>getState：得到仓库中当前的状态</li><li>subscribe：注册一个监听器，监听器是一个无参函数，该分发一个action之后，会运行注册的监听器。该函数会返回一个函数，用于取消监听</li></ul><h2 id="手写bindactioncreators" tabindex="-1"><a class="header-anchor" href="#手写bindactioncreators" aria-hidden="true">#</a> 手写bindActionCreators</h2><h2 id="手写combinereducers" tabindex="-1"><a class="header-anchor" href="#手写combinereducers" aria-hidden="true">#</a> 手写combineReducers</h2><p>组装reducers，返回一个reducer，数据使用一个对象表示，对象的属性名与传递的参数对象保持一致</p><h2 id="redux中间件-middleware" tabindex="-1"><a class="header-anchor" href="#redux中间件-middleware" aria-hidden="true">#</a> Redux中间件（Middleware）</h2><p>中间件：类似于插件，可以在不影响原本功能、并且不改动原本代码的基础上，对其功能进行增强。在Redux中，中间件主要用于增强dispatch函数。 实现Redux中间件的基本原理，是更改仓库中的dispatch函数。 Redux中间件书写：</p><ul><li>中间件本身是一个函数，该函数接收一个store参数，表示创建的仓库，该仓库并非一个完整的仓库对象，仅包含getState，dispatch。该函数运行的时间，是在仓库创建之后运行。 <ul><li>由于创建仓库后需要自动运行设置的中间件函数，因此，需要在创建仓库时，告诉仓库有哪些中间件</li><li>需要调用applyMiddleware函数，将函数的返回结果作为createStore的第二或第三个参数。</li></ul></li><li>中间件函数必须返回一个dispatch创建函数</li><li>applyMiddleware函数，用于记录有哪些中间件，它会返回一个函数 <ul><li>该函数用于记录创建仓库的方法，然后又返回一个函数</li></ul></li></ul><h2 id="手写applymiddleware" tabindex="-1"><a class="header-anchor" href="#手写applymiddleware" aria-hidden="true">#</a> 手写applyMiddleware</h2><p>middleware的本质，是一个调用后可以得到dispatch创建函数的函数 compose：函数组合，将一个数组中的函数进行组合，形成一个新的函数，该函数调用时，实际上是反向调用之前组合的函数</p><h2 id="利用中间件进行副作用处理" tabindex="-1"><a class="header-anchor" href="#利用中间件进行副作用处理" aria-hidden="true">#</a> 利用中间件进行副作用处理</h2><ul><li>redux-thunk</li></ul><p>thunk允许action是一个带有副作用的函数，当action是一个函数被分发时，thunk会阻止action继续向后移交。 thunk会向函数中传递三个参数：</p><ul><li>dispatch：来自于store.dispatch</li><li>getState：来自于store.getState</li><li>extra：来自于用户设置的额外参数</li><li>redux-promise</li><li>redux-saga</li></ul><h2 id="用-reudx-thunk-管理学生数据" tabindex="-1"><a class="header-anchor" href="#用-reudx-thunk-管理学生数据" aria-hidden="true">#</a> 用 Reudx + thunk 管理学生数据</h2><p>需求：根据关键字、性别、分页信息查询学生 <strong>查询条件</strong></p><ul><li>关键字：字符串，可为空字符串</li><li>性别：1、0、-1，分别表示查询女、男、不限</li><li>当前页码</li><li>页容量</li></ul><p><strong>查询结果</strong></p><ul><li>学生数组</li><li>学生总数</li><li>查询状态：是否正在查询中</li></ul><h2 id="redux-promise" tabindex="-1"><a class="header-anchor" href="#redux-promise" aria-hidden="true">#</a> redux-promise</h2><p>如果action是一个promise，则会等待promise完成，将完成的结果作为action触发，如果action不是一个promise，则判断其payload是否是一个promise，如果是，等待promise完成，然后将得到的结果作为payload的值触发。</p><h2 id="迭代器和可迭代协议" tabindex="-1"><a class="header-anchor" href="#迭代器和可迭代协议" aria-hidden="true">#</a> 迭代器和可迭代协议</h2><ul><li>解决副作用的 redux 中间件 <ul><li>redux-thunk：需要改动action，可接收action是一个函数</li><li>redux-promise：需要改动action，可接收action，是一个promise对象；或action的payload，是一个promise对象</li></ul></li><li>以上两个中间件，会导致action或action创建函数不再纯净</li><li>redux-saga将解决这样的问题，它不仅可以保持action、action创建函数、reducer的纯净，而且可以用模块化的方式解决副作用，并且功能非常强大</li><li>redux-saga是建立在ES6的生成器基础上的，要熟练的使用saga，必须理解生成器， 要理解生成器，必须先理解迭代器和可迭代协议。</li></ul><h3 id="迭代" tabindex="-1"><a class="header-anchor" href="#迭代" aria-hidden="true">#</a> 迭代</h3><p>类似于遍历 遍历：有多个数据组成的集合数据结构（map、set、array等其他类数组），需要从该结构中依次取出数据进行某种处理。 迭代：按照某种逻辑，依次取出下一个数据进行处理</p><h3 id="迭代器-iterator" tabindex="-1"><a class="header-anchor" href="#迭代器-iterator" aria-hidden="true">#</a> 迭代器 iterator</h3><p>JS语言规定，如果一个对象具有next方法，并且next方法满足一定的约束，则该对象是一个迭代器（iterator）。 next方法的约束：该方法必须返回一个对象，该对象至少具有两个属性：</p><ul><li>value：any类型，下一个数据的值，如果done属性为true，通常，会将value设置为undefined</li><li>done：bool类型，是否已经迭代完成</li></ul><p>通过迭代器的next方法，可以依次取出数据，并可以根据返回的done属性，判定是否迭代结束。</p><h4 id="迭代器创建函数-iterator-creator" tabindex="-1"><a class="header-anchor" href="#迭代器创建函数-iterator-creator" aria-hidden="true">#</a> 迭代器创建函数 iterator creator</h4><p>它是指一个函数，调用该函数后，返回一个迭代器，则该函数称之为迭代器创建函数，可以简称位迭代器函数。</p><h3 id="可迭代协议" tabindex="-1"><a class="header-anchor" href="#可迭代协议" aria-hidden="true">#</a> 可迭代协议</h3><p>ES6中出现了for-of循环，该循环就是用于迭代某个对象的，因此，for-of循环要求对象必须是可迭代的（对象必须满足可迭代协议） 可迭代协议是用于约束一个对象的，如果一个对象满足下面的规范，则该对象满足可迭代协议，也称之为该对象是可以被迭代的。 可迭代协议的约束如下：</p><ol><li>对象必须有一个知名符号属性（Symbol.iterator）</li><li>该属性必须是一个无参的迭代器创建函数</li></ol><h3 id="for-of循环的原理" tabindex="-1"><a class="header-anchor" href="#for-of循环的原理" aria-hidden="true">#</a> for-of循环的原理</h3><p>调用对象的[Symbol.iterator]方法，得到一个迭代器。不断调用next方法，只有返回的done为false，则将返回的value传递给变量，然后进入循环体执行一次。</p><h2 id="生成器-generator" tabindex="-1"><a class="header-anchor" href="#生成器-generator" aria-hidden="true">#</a> 生成器 generator</h2><h3 id="generator" tabindex="-1"><a class="header-anchor" href="#generator" aria-hidden="true">#</a> generator</h3><p>生成器：由构造函数Generator创建的对象，该对象既是一个迭代器，同时，又是一个可迭代对象（满足可迭代协议的对象）</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//伪代码</span>
<span class="token keyword">var</span> generator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
generator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 它具有next方法</span>
<span class="token keyword">var</span> iterator <span class="token operator">=</span> generator<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 它也是一个可迭代对象</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> generator<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 由于它是一个可迭代对象，因此也可以使用for of循环</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>注意：Generator构造函数，不提供给开发者使用，仅作为JS引擎内部使用</strong></p><h3 id="generator-function" tabindex="-1"><a class="header-anchor" href="#generator-function" aria-hidden="true">#</a> generator function</h3><p>生成器函数（生成器创建函数）：该函数用于创建一个生成器。 ES6新增了一个特殊的函数，叫做生成器函数，只要在函数名与function关键字之间加上一个*号，则该函数会自动返回一个生成器 生成器函数的特点：</p><ul><li>调用生成器函数，会返回一个生成器，而不是执行函数体（因为，生成器函数的函数体执行，收到生成器控制）</li><li>每当调用了生成器的next方法，生成器的函数体会从上一次yield的位置（或开始位置）运行到下一个yield <ul><li>yield关键字只能在生成器内部使用，不可以在普通函数内部使用</li><li>它表示暂停，并返回一个当前迭代的数据</li><li>如果没有下一个yield，到了函数结束，则生成器的next方法得到的结果中的done为true</li></ul></li><li>yield关键字后面的表达式返回的数据，会作为当前迭代的数据</li><li>生成器函数的返回值，会作为迭代结束时的value <ul><li>但是，如果在结束过后，仍然反复调用next，则value为undefined</li></ul></li><li>生成器调用next的时候，可以传递参数，该参数会作为生成器函数体上一次yield表达式的值。 <ul><li>生成器第一次调用next函数时，传递参数没有任何意义</li></ul></li><li>生成器带有一个throw方法，该方法与next的效果相同，唯一的区别在于： <ul><li>next方法传递的参数会被返回成一个正常值</li><li>throw方法传递的参数是一个错误对象，会导致生成器函数内部发生一个错误。</li></ul></li><li>生成器带有一个return方法，该方法会直接结束生成器函数</li><li>若需要在生成器内部调用其他生成器，注意：如果直接调用，得到的是一个生成器，如果加入<em>号调用，则进入其生成器内部执行。如果是yield</em> 函数()调用生成器函数，则该函数的返回结果，为该表达式的结果</li></ul><h2 id="redux-saga" tabindex="-1"><a class="header-anchor" href="#redux-saga" aria-hidden="true">#</a> redux-saga</h2><p>中文文档地址：<a href="https://gitee.com/link?target=https%3A%2F%2Fredux-saga-in-chinese.js.org%2F" target="_blank" rel="noopener noreferrer">https://redux-saga-in-chinese.js.org/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li>纯净</li><li>强大</li><li>灵活</li></ul><p><img src="/vuepress_blog/assets/14-ad482fd7.png" alt="image.png"> 在saga任务中，如果yield了一个普通数据，saga不作任何处理，仅仅将数据传递给yield表达式（把得到的数据放到next的参数中），因此，在saga中，yield一个普通数据没什么意义。 saga需要你在yield后面放上一些合适的saga指令（saga effects），如果放的是指令，saga中间件会根据不同的指令进行特殊处理，以控制整个任务的流程。 每个指令本质上就是一个函数，该函数调用后，会返回一个指令对象，saga会接收到该指令对象，进行各种处理。 <strong>一旦saga任务完成（生成器函数运行完成），则saga中间件一定结束</strong></p><ul><li>take指令：【阻塞】监听某个action，如果action发生了，则会进行下一步处理，take指令仅监听一次。yield得到的是完整的action对象</li><li>all指令：【阻塞】该函数传入一个数组，数组中放入生成器，saga会等待所有的生成器全部完成后才会进一步处理</li><li>takeEvery指令：不断的监听某个action，当某个action到达之后，运行一个函数。takeEvery永远不会结束当前的生成器</li><li>delay指令：【阻塞】阻塞指定的毫秒数</li><li>put指令：用于重新触发action，相当于dispatch一个action</li><li>call指令：【可能阻塞】用于副作用（通常是异步）函数调用</li><li>apply指令：【可能阻塞】用于副作用（通常是异步）函数调用</li><li>select指令：用于得到当前仓库中的数据</li><li>cps指令：【可能阻塞】用于调用那些传统的回调方式的异步函数</li><li>fork：用于开启一个新的任务，该任务不会阻塞，该函数需要传递一个生成器函数，fork返回了一个对象，类型为Task</li><li>cancel：用于取消一个或多个任务，实际上，取消的实现原理，是利用generator.return。cancel可以不传递参数，如果不传递参数，则取消当前任务线。</li><li>takeLastest：功能和takeEvery一致，只不过，会自动取消掉之前开启的任务</li><li>cancelled：判断当前任务线是否被取消掉了</li><li>race：【阻塞】竞赛，可以传递多个指令，当其中任何一个指令结束后，会直接结束，与Promise.race类似。返回的结果，是最先完成的指令结果。并且，该函数会自动取消其他的任务</li></ul><h3 id="手写saga" tabindex="-1"><a class="header-anchor" href="#手写saga" aria-hidden="true">#</a> 手写saga</h3><p>saga中间件的原理：</p><ol><li>首先启动一个任务</li><li>当action触发时，直接将action分发到下一个中间件</li></ol><p>源码分析：</p><ol><li>runSaga：一个函数，用于启动一个任务，一个任务的本质是一个generator function，runSaga在内部得到该函数的generator，并控制生成器的每一次迭代。</li></ol><h2 id="react-redux" tabindex="-1"><a class="header-anchor" href="#react-redux" aria-hidden="true">#</a> react-redux</h2><ul><li>React: 组件化的UI界面处理方案</li><li>React-Router: 根据地址匹配路由，最终渲染不同的组件</li><li>Redux：处理数据以及数据变化的方案（主要用于处理共享数据）</li></ul><p>如果一个组件，仅用于渲染一个UI界面，而没有状态（通常是一个函数组件），该组件叫做<strong>展示组件</strong> 如果一个组件，仅用于提供数据，没有任何属于自己的UI界面，则该组件叫做<strong>容器组件</strong>，容器组件纯粹是为了给其他组件提供数据。 react-redux库：链接redux和react</p><ul><li>Provider组件：没有任何UI界面，该组件的作用，是将redux的仓库放到一个上下文中。</li><li>connect：高阶组件，用于链接仓库和组件的 <ul><li>细节一：如果对返回的容器组件加上额外的属性，则这些属性会直接传递到展示组件</li><li>第一个参数：mapStateToProps: <ul><li>参数1：整个仓库的状态</li><li>参数2：使用者传递的属性对象</li></ul></li><li>第二个参数： <ul><li>情况1：传递一个函数 mapDispatchToProps <ul><li>参数1：dispatch函数</li><li>参数2：使用者传递的属性对象</li><li>函数返回的对象会作为属性传递到展示组件中（作为事件处理函数存在）</li></ul></li><li>情况2：传递一个对象，对象的每个属性是一个action创建函数，当事件触发时，会自动的dispatch函数返回的action</li></ul></li><li>细节二：如果不传递第二个参数，通过connect连接的组件，会自动得到一个属性：dispatch，使得组件有能力自行触发action，但是，不推荐这样做。</li></ul></li></ul><h3 id="react-redux-其他api" tabindex="-1"><a class="header-anchor" href="#react-redux-其他api" aria-hidden="true">#</a> react-redux 其他api</h3><p>详情参考：<a href="https://gitee.com/link?target=https%3A%2F%2Freact-redux.js.org%2Fapi" target="_blank" rel="noopener noreferrer">https://react-redux.js.org/api<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="connect" tabindex="-1"><a class="header-anchor" href="#connect" aria-hidden="true">#</a> connect</h4><ul><li>mergeProps: 一个函数 <ul><li>参数1：stateProps，该参数的值来自于mapStateToProps返回的值</li><li>参数2：dispatchProps，该参数的值来自于mapDispatchToProps返回的值</li><li>参数3：ownProps，来自于组件使用者传递的属性</li><li>返回值：一个对象，该对象的属性最终会被传递到包装的组件中。</li></ul></li><li>options：配置对象</li></ul><h4 id="connectadvanced" tabindex="-1"><a class="header-anchor" href="#connectadvanced" aria-hidden="true">#</a> connectAdvanced</h4><p>该函数和connect一样，也是用于连接React组件和Redux仓库的，只不过它的配置比connect少一些 该函数需要传递两个参数：</p><ul><li>selectorFactory <ul><li>参数1：dispatch</li><li>参数2：factoryOptions，配置</li><li>返回：函数 <ul><li>参数1：state</li><li>参数2：ownProps</li><li>返回的是一个对象：该对象的属性最终，会成为包装的组件的属性</li></ul></li></ul></li><li>connectOptions</li></ul><h4 id="createprovider" tabindex="-1"><a class="header-anchor" href="#createprovider" aria-hidden="true">#</a> createProvider</h4><p>createProvider(字符串key)：通过一个唯一的key值创建一个Provider组件。 <code>**var** Provider1 = createProvider(&quot;p1&quot;); **var** Provider2 = createProvider(&quot;p2&quot;);</code></p><h2 id="redux-actions" tabindex="-1"><a class="header-anchor" href="#redux-actions" aria-hidden="true">#</a> redux-actions</h2><p>该库用于简化action-types、action-creator以及reducer 官网文档：<a href="https://gitee.com/link?target=https%3A%2F%2Fredux-actions.js.org%2F" target="_blank" rel="noopener noreferrer">https://redux-actions.js.org/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="createaction-s" tabindex="-1"><a class="header-anchor" href="#createaction-s" aria-hidden="true">#</a> createAction(s)</h3><h4 id="createaction" tabindex="-1"><a class="header-anchor" href="#createaction" aria-hidden="true">#</a> createAction</h4><p>该函数用于帮助你创建一个action创建函数（action creator）</p><h4 id="createactions" tabindex="-1"><a class="header-anchor" href="#createactions" aria-hidden="true">#</a> createActions</h4><p>该函数用于帮助你创建多个action创建函数</p><h3 id="handleaction-s" tabindex="-1"><a class="header-anchor" href="#handleaction-s" aria-hidden="true">#</a> handleAction(s)</h3><h4 id="handleaction" tabindex="-1"><a class="header-anchor" href="#handleaction" aria-hidden="true">#</a> handleAction</h4><p>简化针对单个action类型的reducer处理，当它匹配到对应的action类型后，会执行对应的函数</p><h4 id="handleactions" tabindex="-1"><a class="header-anchor" href="#handleactions" aria-hidden="true">#</a> handleActions</h4><p>简化针对多个action类型的reducre处理</p><h3 id="combineactions" tabindex="-1"><a class="header-anchor" href="#combineactions" aria-hidden="true">#</a> combineActions</h3><p>配合createActions和handleActions两个函数，用于处理多个action-type对应同一个reducer处理函数。</p><h1 id="redux和router的结合-connected-react-router" tabindex="-1"><a class="header-anchor" href="#redux和router的结合-connected-react-router" aria-hidden="true">#</a> redux和router的结合（connected-react-router）</h1><ol><li>chrome插件：redux-devtools</li><li>使用npm安装第三方库：redux-devtools-extension</li></ol><p>用于将redux和react-router进行结合 本质上，router中的某些数据可能会跟数据仓库中的数据进行联动 该组件会将下面的路由数据和仓库保持同步</p><ol><li>action：它不是redux的action，它表示当前路由跳转的方式（PUSH、POP、REPLACE）</li><li>location：它记录了当前的地址信息</li></ol><p>该库中的内容：</p><h2 id="connectrouter" tabindex="-1"><a class="header-anchor" href="#connectrouter" aria-hidden="true">#</a> connectRouter</h2><p>这是一个函数，调用它，会返回一个用于管理仓库中路由信息的reducer，该函数需要传递一个参数，参数是一个history对象。该对象，可以使用第三方库history得到。</p><h2 id="routermiddleware" tabindex="-1"><a class="header-anchor" href="#routermiddleware" aria-hidden="true">#</a> routerMiddleware</h2><p>该函数会返回一个redux中间件，用于拦截一些特殊的action</p><h2 id="connectedrouter" tabindex="-1"><a class="header-anchor" href="#connectedrouter" aria-hidden="true">#</a> ConnectedRouter</h2><p>这是一个组件，用于向上下文提供一个history对象和其他的路由信息（与react-router提供的信息一致） 之所以需要新制作一个组件，是因为该库必须保证整个过程使用的是同一个history对象</p><h2 id="一些action创建函数" tabindex="-1"><a class="header-anchor" href="#一些action创建函数" aria-hidden="true">#</a> 一些action创建函数</h2><ul><li>push</li><li>replace</li></ul><h2 id="手写connected-react-router" tabindex="-1"><a class="header-anchor" href="#手写connected-react-router" aria-hidden="true">#</a> 手写connected-react-router</h2><ul><li>connectRouter：函数，返回一个reducer</li><li>routerMiddleware：函数，返回一个中间件</li><li>ConnectedRouter：组件，提供路由信息上下文，类似于BrowserRouter、HashRouter。。。</li><li>一些action-creators: <ul><li>push</li><li>replace</li></ul></li></ul><h1 id="dva" tabindex="-1"><a class="header-anchor" href="#dva" aria-hidden="true">#</a> dva</h1><p>官方网站：<a href="https://gitee.com/link?target=https%3A%2F%2Fdvajs.com" target="_blank" rel="noopener noreferrer">https://dvajs.com<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> dva不仅仅是一个第三方库，更是一个框架，它主要整合了redux的相关内容，让我们处理数据更加容易，实际上，dva有很多依赖：react、react-router、redux、redux-saga、react-redux、connected-react-router等。 <img src="/vuepress_blog/assets/15-615c1fd0.png" alt="image.png"></p><h2 id="dva的使用" tabindex="-1"><a class="header-anchor" href="#dva的使用" aria-hidden="true">#</a> dva的使用</h2><ul><li>dva默认导出一个函数，通过调用该函数，可以得到一个dva对象</li><li>dva对象.router：路由方法，传入一个函数，该函数返回一个React节点，将来，应用程序启动后，会自动渲染该节点。</li><li>dva对象.start: 该方法用于启动dva应用程序，可以认为启动的就是react程序，该函数传入一个选择器，用于选中页面中的某个dom元素，react会将内容渲染到该元素内部。</li><li>dva对象.model: 该方法用于定义一个模型，该模型可以理解为redux的action、reducer、redux-saga副作用处理的整合，整合成一个对象，将该对象传入model方法即可。 <ul><li>namespace：命名空间，该属性是一个字符串，字符串的值，会被作为仓库中的属性保存</li><li>state：该模型的默认状态</li><li>reducers: 该属性配置为一个对象，对象中的每个方法就是一个reducer，dva约定，方法的名字，就是匹配的action类型</li><li>effects: 处理副作用，底层是使用redux-saga实现的，该属性配置为一个对象，对象中的每隔方法均处理一个副作用，方法的名字，就是匹配的action类型。 <ul><li>函数的参数1：action</li><li>参数2：封装好的saga/effects对象</li></ul></li><li>subscriptions：配置为一个对象，该对象中可以写任意数量任意名称的属性，每个属性是一个函数，这些函数会在模型加入到仓库中后立即运行。</li></ul></li><li>在dva中同步路由到仓库 <ul><li>在调用dva函数时，配置history对象</li><li>使用ConnectedRouter提供路由上下文</li></ul></li><li>配置： <ul><li>history：同步到仓库的history对象</li><li>initialState：创建redux仓库时，使用的默认状态</li><li>onError: 当仓库的运行发生错误的时候，运行的函数</li><li>onAction: 可以配置redux中间件 <ul><li>传入一个中间件对象</li><li>传入一个中间件数组</li></ul></li><li>onStateChange: 当仓库中的状态发生变化时运行的函数</li><li>onReducer：对模型中的reducer的进一步封装</li><li>onEffect：类似于对模型中的effect的进一步封装</li><li>extraReducers：用于配置额外的reducer，它是一个对象，对象的每一个属性是一个方法，每个方法就是一个需要合并的reducer，方法名即属性名。</li><li>extraEnhancers: 它是用于封装createStore函数的，dva会将原来的仓库创建函数作为参数传递，返回一个新的用于创建仓库的函数。函数必须放置到数组中。</li></ul></li></ul><h2 id="dva插件" tabindex="-1"><a class="header-anchor" href="#dva插件" aria-hidden="true">#</a> dva插件</h2><p>通过dva对象.use(插件)，来使用插件，插件本质上就是一个对象，该对象与配置对象相同，dva会在启动时，将传递的插件对象混合到配置中。</p><h3 id="dva-loading" tabindex="-1"><a class="header-anchor" href="#dva-loading" aria-hidden="true">#</a> dva-loading</h3><p>该插件会在仓库中加入一个状态，名称为loading，它是一个对象，其中有以下属性</p><ul><li>global：全局是否正在处理副作用（加载），只要有任何一个模型在处理副作用，则该属性为true</li><li>models：一个对象，对象中的属性名以及属性的值，表示哪个对应的模型是否在处理副作用中（加载中）</li><li>effects：一个对象，对象中的属性名以及属性的值，表示是哪个action触发了副作用</li></ul><h1 id="umijs-简介" tabindex="-1"><a class="header-anchor" href="#umijs-简介" aria-hidden="true">#</a> umijs 简介</h1><p>官网：<a href="https://gitee.com/link?target=https%3A%2F%2Fumijs.org%2F" target="_blank" rel="noopener noreferrer">https://umijs.org/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li>插件化</li><li>开箱即用</li><li>约定式路由</li></ul><h2 id="全局安装umi" tabindex="-1"><a class="header-anchor" href="#全局安装umi" aria-hidden="true">#</a> 全局安装umi</h2><p>提供了一个命令行工具：umi，通过该命令可以对umi工程进行操作 umi还可以使用对应的脚手架</p><ul><li>dev: 使用开发模式启动工程</li></ul><h2 id="约定式路由" tabindex="-1"><a class="header-anchor" href="#约定式路由" aria-hidden="true">#</a> 约定式路由</h2><p>umi对路由的处理，主要通过两种方式：</p><ol><li><strong>约定式</strong>：使用约定好的文件夹和文件，来代表页面，umi会根据开发者书写的页面，生成路由配置。</li><li>配置式：直接书写路由配置文件</li></ol><h3 id="路由匹配" tabindex="-1"><a class="header-anchor" href="#路由匹配" aria-hidden="true">#</a> 路由匹配</h3><ul><li>umi约定，工程中的pages文件夹中存放的是页面。如果工程包含src目录，则src/pages是页面文件夹。</li><li>umi约定，页面的文件名，以及页面的文件路径，是该页面匹配的路由</li><li>umi约定，如果页面的文件名是index，则可以省略文件名（首页）(注意避免文件名和当前目录中的文件夹名称相同)</li><li>umi约定，如果src/layout目录存在，则该目录中的index.js表示的是全局的通用布局，布局中的children则会添加具体的页面。</li><li>umi约定，如果pages文件夹中包含_layout.js，则layout.js所在的目录以及其所有的子目录中的页面，共用该布局。</li><li>404约定，umi约定，pages/404.js，表示404页面，如果路由无匹配，则会渲染该页面。该约定在开发模式中无效，只有部署后生效。</li><li>使用$名称，会产生动态路由</li></ul><h3 id="路由跳转" tabindex="-1"><a class="header-anchor" href="#路由跳转" aria-hidden="true">#</a> 路由跳转</h3><ul><li>跳转链接： 导入umi/link，umi/navlink</li><li>代码跳转： 导入umi/router</li></ul><p>导入模块时，@表示src目录</p><h3 id="路由信息的获取" tabindex="-1"><a class="header-anchor" href="#路由信息的获取" aria-hidden="true">#</a> 路由信息的获取</h3><p>所有的页面、布局组件，都会通过属性，收到下面的属性</p><ul><li>match：等同于react-router的match</li><li>history：等同于react-router的history（history.location.query被封装成了一个对象，使用的是query-string库进行的封装）</li><li>location：等同于react-router的location（location.query被封装成了一个对象，使用的是query-string库进行的封装）</li><li>route：对应的是路由配置</li></ul><p>如果需要在普通组件中获取路由信息，则需要使用withRouter封装，可以通过umi/withRouter导入</p><h2 id="配置式路由" tabindex="-1"><a class="header-anchor" href="#配置式路由" aria-hidden="true">#</a> 配置式路由</h2><p>当使用了路由配置后，约定式路由全部失效。 两种方式书写umi配置：</p><ol><li>使用根目录下的文件.umirc.js</li><li>使用根目录下的文件config/config.js</li></ol><p>进行路由配置时，每个配置就是一个匹配规则，并且，每个配置是一个对象，对象中的某些属性，会直接形成Route组件的属性 注意：</p><ul><li>component配置项，需要填写页面组件的路径，路径相对于pages文件夹</li><li>如果配置项没有exact，则会自动添加exact为true</li><li>每一个路由配置，可以添加任何属性</li><li>Routes属性是一个数组，数组的每一项是一个组件路径，路径相对于项目根目录，当匹配到路由后，会转而渲染该属性指定的组件，并会将component组件作为children放到匹配的组件中</li></ul><p>路由配置中的信息，同样可以放到约定式路由中，方式是，为约定式路由添加第一个文档注释（注释的格式的YAML），需要将注释放到最开始的位置 YAML格式</p><ul><li>键值对，冒号后需要加上空格</li><li>如果某个属性有多个键或多个值，需要进行缩进（空格）</li></ul><h2 id="使用dva" tabindex="-1"><a class="header-anchor" href="#使用dva" aria-hidden="true">#</a> 使用dva</h2><p>官方插件集 umi-plugin-react 文档：<a href="https://gitee.com/link?target=https%3A%2F%2Fumijs.org%2Fzh%2Fplugin%2Fumi-plugin-react.html" target="_blank" rel="noopener noreferrer">https://umijs.org/zh/plugin/umi-plugin-react.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> dva插件和umi整合后，将模型分为两种：</p><ol><li>全局模型：所有页面通用，工程一开始启动后，模型就会挂载到仓库</li><li>局部模型：只能被某些页面使用，访问具体的页面时才会挂载到仓库</li></ol><h3 id="定义全局模型" tabindex="-1"><a class="header-anchor" href="#定义全局模型" aria-hidden="true">#</a> 定义全局模型</h3><p>在src/models目录下定义的js文件都会被看作是全局模型，默认情况下，模型的命名空间和文件名一致。</p><h3 id="定义局部模型" tabindex="-1"><a class="header-anchor" href="#定义局部模型" aria-hidden="true">#</a> 定义局部模型</h3><p>局部模型定义在pages文件夹或其子文件夹中，在哪个文件夹定义的模型，会被该文件夹中的所有页面以及子页面、以及该文件夹的祖先文件夹中的页面所共享。 局部模型的定义和全局模型的约定类似，需要创建一个models文件夹</p><h2 id="使用样式" tabindex="-1"><a class="header-anchor" href="#使用样式" aria-hidden="true">#</a> 使用样式</h2><p>解决两个问题：</p><ol><li>保证类样式名称的唯一性：css-module</li><li>样式代码的重复：less 或 sass</li></ol><h3 id="局部样式和全局样式" tabindex="-1"><a class="header-anchor" href="#局部样式和全局样式" aria-hidden="true">#</a> 局部样式和全局样式</h3><p>底层使用了webpack的加载器：css-loader（内部包含了css-module的功能） css文件 -&gt; css-module -&gt; 对象</p><ol><li>某个组件特有的样式，不与其他组件共享，通常，将该样式文件与组件放置在同一个目录(非强制性)(要保证类样式名称唯一)</li><li>如果某些样式可能被某些组件共享，这样的样式，通常放到assets/css文件夹中。(要保证类样式名称唯一)</li><li>全局样式，名称一定唯一，不需要css-module处理。umijs约定，src/global.css样式，是全局样式，不会交给css-module处理。</li></ol><h3 id="less" tabindex="-1"><a class="header-anchor" href="#less" aria-hidden="true">#</a> less</h3><p>less代码 -&gt; less-loader -&gt; css代码 -&gt; css-module -&gt; 对象</p><h2 id="代理和数据模拟" tabindex="-1"><a class="header-anchor" href="#代理和数据模拟" aria-hidden="true">#</a> 代理和数据模拟</h2><h3 id="代理" tabindex="-1"><a class="header-anchor" href="#代理" aria-hidden="true">#</a> 代理</h3><p>代理用于解决跨域问题 配置.umirc.js中的proxy，配置方式和devServer中的proxy配置相同</p><h3 id="数据模拟" tabindex="-1"><a class="header-anchor" href="#数据模拟" aria-hidden="true">#</a> 数据模拟</h3><p>用于解决前后端协同开发的问题 数据模拟可以让前端开发者在开发时，无视后端接口是否真正完成，因为使用的是模拟的数据 umijs约定：</p><ol><li>mock文件夹中的文件</li><li>src/pages文件夹中的_mock.js文件</li></ol><p>以上两种JS文件，均会被umijs读取，并作为数据模拟的配置 可以自行发挥，添加模拟数据，通常，我们会和mockjs配合</p><h2 id="配置" tabindex="-1"><a class="header-anchor" href="#配置" aria-hidden="true">#</a> 配置</h2><h3 id="额外的约定文件" tabindex="-1"><a class="header-anchor" href="#额外的约定文件" aria-hidden="true">#</a> 额外的约定文件</h3><ul><li>src/pages/document.ejs: 页面模板文件</li><li>src/global.js：在umi最开始启动时运行的js文件</li><li>src/app.js：作运行时配置的代码 <ul><li>patchRoutes: 函数，该函数会在umi读取完所有静态路由配置后执行</li><li>dva <ul><li>config： 相当于new dva(配置)</li><li>plugins： 相当于dva.use(插件)</li></ul></li></ul></li><li>.env: 配置环境变量，这些变量会在umi编译期间发挥作用 <ul><li>UMI_ENV：umi的环境变量值，可以是任意值，该值会影响到.umirc.js</li><li>PORT</li><li>MOCK</li></ul></li></ul><h3 id="umirc配置" tabindex="-1"><a class="header-anchor" href="#umirc配置" aria-hidden="true">#</a> umirc配置</h3><h4 id="umi配置" tabindex="-1"><a class="header-anchor" href="#umi配置" aria-hidden="true">#</a> umi配置</h4><p>书写在.umirc.js文件中的配置</p><ul><li>plugins：配置umijs的插件</li><li>routes：配置路由（会导致约定式路由失效）</li><li>history：history对象模式（默认是browser）</li><li>outputPath：使用umi build后，打包的目录名称，默认./dist</li><li>base: 相当于之前BrowserRouter中的basename</li><li>publicPath: 指定静态资源所在的目录</li><li>exportStatic: 开启该配置后，会打包成多个静态页面，每个页面对应一个路由，开启多静态页面应用的前提条件是：没有动态路由</li></ul><h4 id="webpack配置" tabindex="-1"><a class="header-anchor" href="#webpack配置" aria-hidden="true">#</a> webpack配置</h4><h2 id="umi脚手架" tabindex="-1"><a class="header-anchor" href="#umi脚手架" aria-hidden="true">#</a> umi脚手架</h2><p>create-umi</p><h1 id="ant-design" tabindex="-1"><a class="header-anchor" href="#ant-design" aria-hidden="true">#</a> Ant Design</h1><p>官网地址：<a href="https://gitee.com/link?target=https%3A%2F%2Fant.design" target="_blank" rel="noopener noreferrer">https://ant.design<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 对于前端开发者：antd实际上就是一个UI库 网站 = 前台 + 后台 前台：给用户访问的页面，通常需要设计师参与制作 后台：给管理员（通常是公司内部员工）使用，通常设计师不参与后台页面。</p><h2 id="form" tabindex="-1"><a class="header-anchor" href="#form" aria-hidden="true">#</a> Form</h2><ul><li>Form组件：仅提供样式和事件</li><li>form对象：处理数据验证、生成、获取 <ul><li>获取form对象：通过Form.create(配置)得到一个高阶组件，该高阶组件会将form对象作为属性，注入到传递的组件中</li><li>使用form对象 <ul><li>getFieldDecorator：该方法用于产生一个表单元素，通过该方法产生的表单元素会被form对象控制</li></ul></li></ul></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: chenleilong@51yund.com">chenleilong</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/vuepress_blog/note/vue2%E5%AD%A6%E4%B9%A0.html" class="" aria-label="前期准备"><!--[--><!--]--> 前期准备 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/vuepress_blog/assets/app-168a97af.js" defer></script>
  </body>
</html>
